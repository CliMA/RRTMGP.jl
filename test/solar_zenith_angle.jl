using Test
using RRTMGP.SolarZenithAngle

@testset "Solar Zenith Angle" begin
    γ_0 = 23.44
    π_0 = 282.95
    e_0 = 0.017

    ndays = 20
    nlats = 20

    F0 = calc_day_lat_insolation(ndays, nlats, γ_0, π_0, e_0)
    @test all(F0 .≈ [
        545.8655157335097 539.1450054229391 516.1259849051344 499.7819531394744 507.52555576573104 512.1852462940554 508.55643617895976 495.52934094854635 469.596055414477 436.1435637938727 388.56824932978515 337.53923510573617 273.50583350825826 211.256768441881 139.905859749132 77.37765934464612 17.81130999787544 0.0 0.0 0.0
        471.6722713615931 465.86520300587154 445.9748941675079 452.59113021670447 473.0168054577372 486.53101845674905 491.75097316774804 486.17264385441536 468.0091622383919 441.02704693740384 399.91809979340917 353.90131224879445 294.32624756886315 234.8598424500239 164.8513029011888 101.33398344669388 36.12923359968329 0.0 0.0 0.0
        343.86557231268665 339.6320165053148 343.31345978732685 377.98413573429457 415.37906420442386 441.838579833687 460.60126279124654 466.80999761470036 461.2928150873569 445.13214455167224 415.16228519141146 378.1042040020071 326.9472690628994 273.3186493119748 207.3228234344822 144.4092954268969 74.36885639375065 18.18217365659149 0.0 0.0
        170.44216110291748 174.99636991176692 232.5254803450092 286.5069494772788 340.24736635488335 380.6363130562308 414.99150678408165 435.4586299284808 445.867060467541 443.8459763161688 428.99096316972793 404.63336976341924 366.13355748289536 322.16205263511296 264.3950386985329 205.93711053781507 136.01545360978446 71.36925095690937 6.652634644577227 0.0
        0.0 63.796886197218925 137.843185901395 200.98712624649323 265.2851264372745 316.31484864849534 363.8328594216062 397.1824433017903 422.7403589905405 434.7749419746264 435.5873561930484 424.9954116300642 400.973801410512 368.90966195927615 322.67203346716434 272.6304960057841 209.21744080691047 146.65675010706056 73.00353197835003 9.321407778878477
        0.0 3.4521101258819282 64.07782304677109 127.00698932980823 195.66089361672323 253.38890340246397 310.7517767122532 354.70910855806653 393.5672358756434 418.56887760588154 434.473696885384 437.7149180359311 428.93339485899384 410.14150309616883 377.84496703921866 339.46287649588703 288.1337430579254 236.62298870338418 183.69272384102987 182.48733563721404
        0.0 0.0 17.162354314260465 70.98297066260541 138.18756796507452 198.5928535236965 261.98657035779445 313.5237567191162 362.7116923222924 398.3698184733467 427.24353625672217 442.8576966927468 448.2710341111583 442.4193599258273 424.53124331154027 399.2466719621754 363.493582241374 330.40202906337316 327.21004382744076 331.2887581828477
        0.0 0.0 0.0 35.203829989911554 97.12170558316387 157.24342513281755 223.39686713431269 279.5103708836202 335.64543726340986 378.9285232149364 417.4979477812057 442.7042266110687 459.50537498644775 464.41843971935344 459.05124035514535 445.84366423413525 425.93861699459853 418.4246066626998 437.08618326922044 442.5345175238693
        0.0 0.0 0.0 17.1436432682753 73.19353913793458 131.87591486612337 198.76601555164956 257.0774825360287 317.01574044353663 364.7407314822807 409.1859519867689 440.38422605121514 464.49353131090965 476.5056256273717 479.6621483497628 475.0409745428692 467.40428268639886 482.168819388902 503.67336337848417 509.9517152090634
        0.0 0.0 0.0 13.905100537316976 68.30833309129733 126.44806591825001 193.2652295169721 251.85708323239112 312.4180520470447 360.9422699293907 406.50366819779913 438.8847596646671 464.4820876361309 477.9798702800797 482.9684502510867 480.2475886468843 475.47338806658655 494.2777955296154 516.3223952001451 522.7584188034779
        0.0 0.0 0.0 22.435044535434983 80.3270262904467 139.25855752446665 205.62167367513658 262.95354174919765 321.37429362006736 367.4258934845578 409.74170020343536 438.83207497246246 460.432085689931 470.0545086287593 470.38201396212776 462.92155983212905 451.12325835162096 459.06764181921005 479.5418821697301 485.5194320515914
        0.0 0.0 2.505915374291158 45.955727367140035 109.50073462407244 169.37089814206976 234.14505050535612 288.30725667736215 341.674293473506 382.047061210394 417.0331846329245 438.78676169683405 451.579784069116 452.7744591827968 443.1391897874425 425.82460055437355 400.38921029696843 382.05668898182563 396.4785922036595 401.4207477277284
        0.0 0.0 32.900140363316424 90.79160203394306 158.31912218583628 217.2634515548619 277.77708884275137 325.88361059356674 370.55569322419643 401.67742854766357 425.1520152695529 435.71510027119615 435.4343332406933 424.4705350405913 400.9533512993466 370.5624717363098 328.60530410358933 287.5667532602597 266.02464593329984 269.34067660756733
        0.0 20.60656374235203 89.53431642781861 152.71300345255872 219.36026795348005 274.0652009190329 327.10803306419683 366.52647200945006 399.82020541673614 419.50640545210246 429.34134485122735 427.11946427834545 412.4239666545917 388.56688517081346 351.0241290408112 308.2819816955051 252.34770100212512 196.2297285556215 132.06055023524326 112.84327445409949
        60.01016588178808 99.81846344646249 170.07395148601196 229.85689331572104 289.83981999469023 336.44343744083466 378.5292408729659 406.6405511482481 426.1422166640068 432.65625936617226 427.4260287863349 411.6244435786341 382.2322177270677 345.84536203601704 295.5166027223767 242.551163954118 176.87106180333132 113.33322491998499 40.54712228784028 0.0
        232.12653631945963 229.26867346546408 267.73374325150104 315.2627044120637 362.9952018558187 398.1309274345563 426.60564949733777 441.7469978755571 446.28979449349504 439.1456742017795 418.91451351741574 390.13330280810624 347.33262972416725 300.18047675492664 239.82101033769683 180.07699503860323 110.30713793011657 48.25379127192248 0.0 0.0
        384.1891918225798 379.4591853458309 371.87599259472097 398.81498255763046 430.51657800235 452.5165857684564 466.6259451739129 468.83969459411793 459.11926204932087 439.4461148956505 405.96182052673095 366.17548449469797 312.57587240619716 257.3815144764599 190.5001869917203 127.77136342668133 59.596060435467066 8.617975181982677 0.0 0.0
        501.5406497717757 495.3658521140922 474.216000777365 470.1848665070996 485.1800346442798 494.82199896967006 496.18650997663383 487.40321842643397 465.9549602018529 436.29635311207807 392.5842052630759 344.6212954887759 283.4082581722064 223.0278944641243 152.7720983206392 89.96060925321773 27.35075707020833 0.0 0.0 0.0
        556.1284432515457 549.2815792728765 525.829773513467 506.33486427640076 511.8573526633396 515.0420957889604 509.9867515197446 495.7971800308305 468.69238792693477 434.3014998251423 385.8317122904549 334.15274073862855 269.59936390372616 207.09749284281347 135.76340950729596 73.62215899455592 15.302593987066208 0.0 0.0 0.0
        546.4521470100877 539.7244142950439 516.6806556741666 500.16871634717836 507.79962675157515 512.3838770275689 508.6811089211509 495.59265044951144 469.596177021945 436.091751607414 388.46530885869726 337.3974377627563 273.3305385730647 211.06193889168708 139.70440891405767 77.18945857614457 17.680108532029013 0.0 0.0 0.0
    ])
end
