var documenterSearchIndex = {"docs":
[{"location":"MathFormulation/","page":"Mathematical Formulation","title":"Mathematical Formulation","text":"newcommandπpi                                   Math\nnewcommandDELnabla                              Math\nnewcommandDOTcdot                               Math\nnewcommandDIVDEL DOT                           Math\nnewcommandPDpartial                             Math\nnewcommanddagdagger                             Math","category":"page"},{"location":"MathFormulation/","page":"Mathematical Formulation","title":"Mathematical Formulation","text":"newcommanddirdag                                Direct\nnewcommanddifstar                               Diffuse\nnewcommandSFCmathrmsfc                        Surface\nnewcommandTOAmathrmTOA                        Top of atmosphere\nnewcommandFmathcal F                            Generic fluxes in thermal energy equation\nnewcommandFR1F^1_mathrmrad             Radiative flux\nnewcommandτ1tau_1                          Optical depth\nnewcommandthreshtau1tau_1mathrmthresh   Optical depth\nnewcommandSSAtildeomega                      Single scattering albedo\nnewcommandSAvarepsilon_SFC                   Surface albedo\nnewcommandEMISepsilon                           Emissivity\nnewcommandλlambda                               Wavelength\nnewcommandgptxi                                 G-point variable\nnewcommandFSmathcal F_mathcal S              Symbol for source function\nnewcommandOPMAP1mathcal M_1^lambda      Optical properties map\nnewcommandSMAPUpsilon^lambda                 Radiative sources map\nnewcommandKDmathcal K_mathrmdist           Symbol for k-distribution\nnewcommandSVmathcal S                           Symbol for thermal energy equation source term\nnewcommandASmathcal S_mathrmatmos          Symbol for atmospheric state\nnewcommandASYg                                   Asymmetry factor\nnewcommandθtheta                                Solar zenith angle\nnewcommandμmu                                   Cosine of solar zenith angle\nnewcommandϕphi                                  Azimuthal angle\nnewcommandρrho                                  Density \nnewcommandνnu                                   Frequency\nnewcommandRAD1I^1                           Radiative intensity\nnewcommandksk_mathrmscatter                 Absorption coefficient for scattering\nnewcommandkak_mathrmabs                     Absorption coefficient\nnewcommandDAD                                    Secant of propagation angle\nnewcommandtransmittanceT                         Transmittance\nnewcommandtemperatureTheta                      Temperature\nnewcommandpressurep                              Pressure\nnewcommandPhaseFun2P(12)                    Phase function\nnewcommandSpectralPhaseFun2P_ν(12)       Spectral Phase function\nnewcommandScatPhaseFun1P(1)                   Scattering phase function\nnewcommandPlanckF1hatB(1)                  Planck function\nnewcommandPlanckS1B^1                       Layer Planck source\nnewcommandSpecPlanckF1B_ν(1)               Spectral Planck function\nnewcommandRSRC1S^1                          Radiation source\nnewcommandSRSRC1underlineS^1             Surface radiation source\nnewcommandBS1S^1                            Level radiation source","category":"page"},{"location":"MathFormulation/","page":"Mathematical Formulation","title":"Mathematical Formulation","text":"CurrentModule = RRTMGP","category":"page"},{"location":"MathFormulation/#Radiation-in-the-context-of-the-thermal-energy-equation","page":"Mathematical Formulation","title":"Radiation in the context of the thermal energy equation","text":"","category":"section"},{"location":"MathFormulation/","page":"Mathematical Formulation","title":"Mathematical Formulation","text":"Radiative fluxes enter the thermal energy equation as follows:","category":"page"},{"location":"MathFormulation/","page":"Mathematical Formulation","title":"Mathematical Formulation","text":"beginalign\nPD_t (rho e) = - DIV F + SV\nendalign","category":"page"},{"location":"MathFormulation/","page":"Mathematical Formulation","title":"Mathematical Formulation","text":"Here, F = sum_i F_i, with F_j = FRnet = FR+ - FR- for some j. Note that FR+ and FR- denote the sum of diffuse (dif) and direct (dir) upward and downward fluxes respectively.","category":"page"},{"location":"MathFormulation/","page":"Mathematical Formulation","title":"Mathematical Formulation","text":"note: Note\nThere are two implementations in RRTMGP.jl: one that operates on 1) all layers and multiple columns and 2) a single grid point.","category":"page"},{"location":"MathFormulation/#Map-atmospheric-state-to-optical-properties","page":"Mathematical Formulation","title":"Map atmospheric state to optical properties","text":"","category":"section"},{"location":"MathFormulation/","page":"Mathematical Formulation","title":"Mathematical Formulation","text":"To solve for FRnet, one must choose an approximation for optical properties. In RRTMGP.jl, choices include","category":"page"},{"location":"MathFormulation/","page":"Mathematical Formulation","title":"Mathematical Formulation","text":"OneScalar: optical depth (τ) only\nTwoStream: optical depth (τ), single scattering albedo (SSA), asymmetry factor (ASY)","category":"page"},{"location":"MathFormulation/","page":"Mathematical Formulation","title":"Mathematical Formulation","text":"To compute either set of optical properties, one must call compute_optical_props! with the following arguments:","category":"page"},{"location":"MathFormulation/","page":"Mathematical Formulation","title":"Mathematical Formulation","text":"A K-distribution KD, LookUpLW or LookUpSW: typically read from Data files\nAn AtmosphericState AS, defined by: temperature temperature, pressure pressure, set of gas volume mixing ratios (AbstractVmr)\n[optionally] A source function FS, SourceLWNoScat, SourceLW2Str or SourceSW2Str: source functions","category":"page"},{"location":"MathFormulation/","page":"Mathematical Formulation","title":"Mathematical Formulation","text":"Calling Optics.compute_optical_props! computes the optical depths via a 3D interpolation routine in the following simplified steps:","category":"page"},{"location":"MathFormulation/","page":"Mathematical Formulation","title":"Mathematical Formulation","text":"Initialize and compute InterpolationCoefficients\nCompute absorption optical depth τabsorption for major and minor gas species (which has binary variation as a function of height itropo=1,2)\nCompute Rayleigh scattering optical depth τRayleigh\nCompute total optical depth: τtotal = τabsorption+τRayleigh\n[optionally] Compute SSA = τRayleighτtotal\n[optionally] Compute source (if long-wave radiation)","category":"page"},{"location":"MathFormulation/","page":"Mathematical Formulation","title":"Mathematical Formulation","text":"Mathematically, let's write this entire computation as a map (a spectral map, since it maps wavelength/frequency to g-points):","category":"page"},{"location":"MathFormulation/","page":"Mathematical Formulation","title":"Mathematical Formulation","text":"beginalign\nτgpt = OPMAP1(KDASFS) \n(τgptSSA_gptASY_gpt) = OPMAP2(KDASFS) \nendalign","category":"page"},{"location":"MathFormulation/","page":"Mathematical Formulation","title":"Mathematical Formulation","text":"In addition, Optics.compute_optical_props! computes radiative sources (currently Planck sources), which are computed the same regardless of the type of optical properties:","category":"page"},{"location":"MathFormulation/","page":"Mathematical Formulation","title":"Mathematical Formulation","text":"beginalign\nPlanckS*_gptPlanckS+_gptPlanckS-_gpt = SMAP(KDASFS) \nendalign","category":"page"},{"location":"MathFormulation/","page":"Mathematical Formulation","title":"Mathematical Formulation","text":"Using the denoting notation:","category":"page"},{"location":"MathFormulation/","page":"Mathematical Formulation","title":"Mathematical Formulation","text":"beginalign\n* = quad textat average temperature \n+ = quad textupward \n- = quad textdownward\nendalign","category":"page"},{"location":"MathFormulation/#Computing-fluxes-given-optical-depth","page":"Mathematical Formulation","title":"Computing fluxes given optical depth","text":"","category":"section"},{"location":"MathFormulation/","page":"Mathematical Formulation","title":"Mathematical Formulation","text":"note: Note\nThis section is under development","category":"page"},{"location":"MathFormulation/","page":"Mathematical Formulation","title":"Mathematical Formulation","text":"The radiative transfer equation under Thermodynamic Equilibrium (TE) in differential form is","category":"page"},{"location":"MathFormulation/","page":"Mathematical Formulation","title":"Mathematical Formulation","text":"beginalign\nd fracdRAD_νρ k(ν) ds = - RAD_ν + J_ν \nendalign","category":"page"},{"location":"MathFormulation/","page":"Mathematical Formulation","title":"Mathematical Formulation","text":"here RAD_ν is monochromatic intensity, J is the source function and k(ν) = ka(ν)+ks(ν). Define the single scattering albedo and the normalized phase function as below:","category":"page"},{"location":"MathFormulation/","page":"Mathematical Formulation","title":"Mathematical Formulation","text":"beginalign\nSSA(nu) = fracks(nu)k(nu)\nfrac14piint SpectralPhaseFunOmegaOmega^ dOmega^=1\nendalign","category":"page"},{"location":"MathFormulation/","page":"Mathematical Formulation","title":"Mathematical Formulation","text":"The phase function tells the fraction of radiation scattering by an individual particle from Omega^ to Omega, the direction of I_nu. Then J can be written as","category":"page"},{"location":"MathFormulation/","page":"Mathematical Formulation","title":"Mathematical Formulation","text":"beginalign\n    J_nu = (1-SSA_nu)SpecPlanckFT + fracSSA_nu4piint_4pi I_nu(Omega^)SpectralPhaseFunOmegaOmega^dOmega^\nendalign","category":"page"},{"location":"MathFormulation/","page":"Mathematical Formulation","title":"Mathematical Formulation","text":"If we define the optical depth dτ as opposite to ds, i.e., dτ = -rho k(nu)ds. Therefore, the radiative transfer equation is equivalent to","category":"page"},{"location":"MathFormulation/","page":"Mathematical Formulation","title":"Mathematical Formulation","text":"beginalign\n    fracdRAD_nu(Omega)dτ = RAD_nu(Omega) -\n    (1-SSA_nu)SpecPlanckFT -\n    fracSSA_nu4piint_4pi\n    RAD_nu(Omega^) SpectralPhaseFunOmegaOmega^ dOmega^\nendalign","category":"page"},{"location":"MathFormulation/","page":"Mathematical Formulation","title":"Mathematical Formulation","text":"The terms of right hand side is the attenuation by absorption and scattering, emission, and scattering, respectively.","category":"page"},{"location":"MathFormulation/#Equations-derived-from-code","page":"Mathematical Formulation","title":"Equations derived from code","text":"","category":"section"},{"location":"MathFormulation/#Short-wave,-without-scattering-(one-scalar)","page":"Mathematical Formulation","title":"Short-wave, without scattering (one-scalar)","text":"","category":"section"},{"location":"MathFormulation/","page":"Mathematical Formulation","title":"Mathematical Formulation","text":"beginalign\nFR+ = 0 \nFR- = FRdir = sum_gpt RADdir_gpt \nRADdir_gpt = RADdirTOA_gpt e^-τ  μ \nendalign","category":"page"},{"location":"MathFormulation/#Long-wave,-without-scattering-(one-scalar)","page":"Mathematical Formulation","title":"Long-wave, without scattering (one-scalar)","text":"","category":"section"},{"location":"MathFormulation/","page":"Mathematical Formulation","title":"Mathematical Formulation","text":"beginalign\nFRpm = sum_gpt RADpm_gpt \nRADpm_gpt = 2 π sum_μ RADpm_gptμ w_μ \nD = textquadrature secants \ntransmittance = e^-τ D \nf = begincases\n  frac1 - transmittanceτ - transmittance  τ  threshtau \n  τ left(frac12 - fracτ3 right)   textotherwise \nendcases \nRSRCpm_gpt = (1 - transmittance) PlanckSpm_gpt + 2 f (PlanckS*_gpt - PlanckSpm_gpt) \nRAD+_gptμ = transmittance RADSFC_gptμ + RSRC+_gpt \nRAD-_gptμ = transmittance RADTOA_gptμ + RSRC-_gpt \nendalign","category":"page"},{"location":"MathFormulation/#Short-wave,-with-scattering-(two-stream)","page":"Mathematical Formulation","title":"Short-wave, with scattering (two-stream)","text":"","category":"section"},{"location":"MathFormulation/#Long-wave,-with-scattering-(two-stream)","page":"Mathematical Formulation","title":"Long-wave, with scattering (two-stream)","text":"","category":"section"},{"location":"MathFormulation/#Data-files","page":"Mathematical Formulation","title":"Data files","text":"","category":"section"},{"location":"MathFormulation/","page":"Mathematical Formulation","title":"Mathematical Formulation","text":"allsky (has both up/down fluxes)\nclear-sky long-wave downward flux\nclear-sky long-wave upward flux\nclear-sky short-wave downward flux\nclear-sky short-wave upward flux\nRFMIP profiles","category":"page"},{"location":"MathFormulation/","page":"Mathematical Formulation","title":"Mathematical Formulation","text":"See data_files_dict to see how files are saved.","category":"page"},{"location":"optics/GrayUtils/#Utilities-for-gray-radiation-simulation","page":"Utilities for gray radiation simulation","title":"Utilities for gray radiation simulation","text":"","category":"section"},{"location":"optics/GrayUtils/","page":"Utilities for gray radiation simulation","title":"Utilities for gray radiation simulation","text":"CurrentModule = RRTMGP.GrayUtils","category":"page"},{"location":"optics/GrayUtils/","page":"Utilities for gray radiation simulation","title":"Utilities for gray radiation simulation","text":"update_profile_lw!\ncompute_gray_heating_rate!","category":"page"},{"location":"optics/GrayUtils/#RRTMGP.GrayUtils.update_profile_lw!","page":"Utilities for gray radiation simulation","title":"RRTMGP.GrayUtils.update_profile_lw!","text":"update_profile_lw!(\n    param_set,\n    t_lay,\n    t_lev,\n    flux_dn,\n    flux_net,\n    hr_lay,\n    flux_grad,\n    T_ex_lev,\n    Δt,\n    nlay,\n    nlev,\n    ncol,\n    ::Type{FT},\n)\n\nUpdates tlay and tlev based on heating rate.\n\n\n\n\n\n","category":"function"},{"location":"optics/GrayUtils/#RRTMGP.GrayUtils.compute_gray_heating_rate!","page":"Utilities for gray radiation simulation","title":"RRTMGP.GrayUtils.compute_gray_heating_rate!","text":"compute_gray_heating_rate!(\n    hr_lay,\n    p_lev,\n    ncol,\n    nlay,\n    flux_net,\n    param_set,\n    ::Type{FT},\n)\n\nComputes the heating rate for the gray radiation simulation.\n\n\n\n\n\n","category":"function"},{"location":"optics/LookUpTables/#Lookup-tables","page":"Lookup Tables","title":"Lookup tables","text":"","category":"section"},{"location":"optics/LookUpTables/","page":"Lookup Tables","title":"Lookup Tables","text":"CurrentModule = RRTMGP.LookUpTables","category":"page"},{"location":"optics/LookUpTables/","page":"Lookup Tables","title":"Lookup Tables","text":"LookUpLW\nLookUpSW\nLookUpCld\nAbstractLookUp","category":"page"},{"location":"optics/LookUpTables/#RRTMGP.LookUpTables.LookUpLW","page":"Lookup Tables","title":"RRTMGP.LookUpTables.LookUpLW","text":"LookUpLW{I,FT,UI8,UI8A1D,IA1D,IA2D,IA3D,FTA1D,FTA2D,FTA3D,FTA4D} <: \n    AbstractLookUp{I,FT}\n\nLongwave lookup tables, used to compute optical properties. \n\nFields\n\nn_gases\nnumber of gases used in the lookup table\nn_bnd\nnumber of longwave bands\nn_gpt\nnumber of g-points\nn_atmos_layers\nnumber of atmospheric layers (=2, lower and upper atmospheres)\nn_t_ref\nnumber of reference temperatures for absorption coefficient lookup table\nn_p_ref\nnumber of reference pressures for absorption lookup table\nn_η\nnumber of reference binary mixing fractions, for absorption coefficient lookup table\nn_t_plnk\nnumber of reference temperatures, for Planck source calculations\nn_maj_absrb\nnumber of major absorbing gases\nn_min_absrb\nnumber of minor absorbing gases\nn_min_absrb_lower\nnumber of minor absorbers in lower atmosphere\nn_min_absrb_upper\nnumber of minor absorbers in upper atmosphere\nn_absrb_ext\nn_contrib_lower\nnumber of minor contributors in the lower atmosphere\nn_contrib_upper\nnumber of minor contributors in the upper atmosphere\nidx_h2o\nvmr array index for h2o\np_ref_tropo\nReference pressure separating upper and lower atmosphere\nt_ref_absrb\nReference temperature\np_ref_absrb\nReference pressure\np_ref_min\nminimum pressure supported by RRTMGP lookup tables\nΔ_t_ref\nΔt for reference temperature values (Δt is constant)\nΔ_ln_p_ref\nΔ for log of reference pressure values (Δp is constant)\nidx_gases_minor_lower\nindices for minor gases contributing to absorption in the lower atmosphere (n_min_absrb_lower)\nidx_gases_minor_upper\nindices for minor gases contributing to absorption in the upper atmosphere (n_min_absrb_upper)\nidx_scaling_gas_lower\nindices for scaling gases in the lower atmosphere (n_min_absrb_lower)\nidx_scaling_gas_upper\nindices for scaling gases in the upper atmosphere (n_min_absrb_upper)\nkey_species\nmajor absorbing species in each band (2, n_atmos_layers, n_bnd)\nkmajor\nmajor absorption coefficient (n_gpt, n_η, n_p_ref, n_t_ref)\nkminor_lower\nminor absorption coefficient in lower atmosphere (n_contrib_lower, n_η, n_t_ref)\nkminor_upper\nminor absorption coefficient in upper atmosphere (n_contrib_upper, n_η, n_t_ref)\nkminor_start_lower\nkminor_start_upper\nplanck_fraction\nPlanck fraction (n_gpt, n_η, n_p_ref, n_t_ref)\nt_planck\nreference temperatures for Planck source calculations (n_t_plnk)\ntotplnk\ntotal Planck source for each band (n_t_plnk, n_bnd)\nmajor_gpt2bnd\nmap from g-point to band\nbnd_lims_gpt\nstarting and ending g-point for each band (2, n_bnd)\nbnd_lims_wn\nstarting and ending wavenumber for each band (2, n_bnd)\nminor_lower_gpt_lims\ng-point limits for minor contributors in lower atmosphere (2, n_contrib_lower)\nminor_upper_gpt_lims\ng-point limits for minor contributors in upper atmosphere (2, n_contrib_upper)\nminor_lower_bnd\nband number for minor contributor in the lower atmosphere (n_contrib_lower)\nminor_upper_bnd\nband number for minor contributor in the upper atmosphere (n_contrib_upper)\nminor_lower_bnd_st\nstarting index to idx_gases_minor_lower for each band (n_bnd)\nminor_upper_bnd_st\nstarting index to idx_gases_minor_upper for each band (n_bnd)\nminor_lower_gpt_sh\nshift in kminor_lower for each band (n_min_absrb_lower)\nminor_upper_gpt_sh\nshift in kminor_upper for each band (n_min_absrb_upper)\nminor_lower_scales_with_density\nminor gas (lower atmosphere) scales with density? (n_min_absrb_lower)\nminor_upper_scales_with_density\nminor gas (upper atmosphere) scales with density? (n_min_absrb_upper)\nlower_scale_by_complement\nminor gas (lower atmosphere) scales by compliment (n_min_absrb_lower)\nupper_scale_by_complement\nminor gas (upper atmosphere) scales by compliment (n_min_absrb_upper)\np_ref\nreference pressures used by the lookup table (n_p_ref)\nt_ref\nreference temperatures used by the lookup table (n_t_ref)\nvmr_ref\nreference volume mixing ratios used by the lookup table (2, n_gases, n_t_ref)\n\n\n\n\n\n","category":"type"},{"location":"optics/LookUpTables/#RRTMGP.LookUpTables.LookUpSW","page":"Lookup Tables","title":"RRTMGP.LookUpTables.LookUpSW","text":"LookUpSW{I,FT,UI8,UI8A1D,IA1D,IA2D,IA3D,FTA1D,FTA2D,FTA3D,FTA4D} <:\n    AbstractLookUp{I,FT}\n\nShortwave lookup tables, used to compute optical properties. \n\nFields\n\nn_gases\nnumber of gases used in the lookup table\nn_bnd\nnumber of shortwave bands\nn_gpt\nnumber of g-points\nn_atmos_layers\nnumber of atmospheric layers (=2, lower and upper atmospheres)\nn_t_ref\nnumber of reference temperatures for absorption coefficient lookup table\nn_p_ref\nnumber of reference pressures for absorption lookup table\nn_η\nnumber of reference binary mixing fractions, for absorption coefficient lookup table\nn_maj_absrb\nnumber of major absorbing gases\nn_min_absrb\nnumber of minor absorbing gases\nn_min_absrb_lower\nnumber of minor absorbers in lower atmosphere\nn_min_absrb_upper\nnumber of minor absorbers in upper atmosphere\nn_absrb_ext\nn_contrib_lower\nnumber of minor contributors in the lower atmosphere\nn_contrib_upper\nnumber of minor contributors in the upper atmosphere\nidx_h2o\nvmr array index for h2o\np_ref_tropo\nReference pressure separating upper and lower atmosphere\nt_ref_absrb\nReference temperature\np_ref_absrb\nReference pressure\np_ref_min\nminimum pressure supported by RRTMGP lookup tables\nΔ_t_ref\nΔt for reference temperature values (Δt is constant, array is linearly equispaced)\nΔ_ln_p_ref\nΔ for log of reference pressure values (Δ is constant, equispaced on logarithmic scale)\nsolar_src_tot\ntotal solar irradiation\nidx_gases_minor_lower\nindices for minor gases contributing to absorption in the lower atmosphere (n_min_absrb_lower)\nidx_gases_minor_upper\nindices for minor gases contributing to absorption in the upper atmosphere (n_min_absrb_upper)\nidx_scaling_gas_lower\nindices for scaling gases in the lower atmosphere (n_min_absrb_lower)\nidx_scaling_gas_upper\nindices for scaling gases in the upper atmosphere (n_min_absrb_upper)\nkey_species\nmajor absorbing species in each band (2, n_atmos_layers, n_bnd)\nkmajor\nmajor absorption coefficient (n_gpt, n_η, n_p_ref, n_t_ref)\nkminor_lower\nminor absorption coefficient in lower atmosphere (n_contrib_lower, n_η, n_t_ref)\nkminor_upper\nminor absorption coefficient in upper atmosphere (n_contrib_upper, n_η, n_t_ref)\nkminor_start_lower\nkminor_start_upper\nmajor_gpt2bnd\nmap from g-point to band\nbnd_lims_gpt\nstarting and ending g-point for each band (2, n_bnd)\nbnd_lims_wn\nstarting and ending wavenumber for each band (2, n_bnd)\nminor_lower_gpt_lims\ng-point limits for minor contributors in lower atmosphere (2, n_contrib_lower)\nminor_upper_gpt_lims\ng-point limits for minor contributors in upper atmosphere (2, n_contrib_upper)\nminor_lower_bnd\nband number for minor contributor in the lower atmosphere (n_contrib_lower)\nminor_upper_bnd\nband number for minor contributor in the upper atmosphere (n_contrib_upper)\nminor_lower_bnd_st\nstarting index to idx_gases_minor_lower for each band\nminor_upper_bnd_st\nstarting index to idx_gases_minor_upper for each band\nminor_lower_gpt_sh\nshift in kminor_lower for each band (n_min_absrb_lower)\nminor_upper_gpt_sh\nshift in kminor_upper for each band (n_min_absrb_upper)\nminor_lower_scales_with_density\nminor gas (lower atmosphere) scales with density? (n_min_absrb_lower)\nminor_upper_scales_with_density\nminor gas (upper atmosphere) scales with density? (n_min_absrb_upper)\nlower_scale_by_complement\nminor gas (lower atmosphere) scales by compliment (n_min_absrb_lower)\nupper_scale_by_complement\nminor gas (upper atmosphere) scales by compliment (n_min_absrb_upper)\np_ref\nreference pressures used by the lookup table (n_p_ref)\nt_ref\nreference temperatures used by the lookup table (n_t_ref)\nvmr_ref\nreference volume mixing ratios used by the lookup table (2, n_gases, n_t_ref)\nrayl_lower\nRayleigh absorption coefficient for lower atmosphere (n_gpt, n_η, n_t_ref)\nrayl_upper\nRayleigh absorption coefficient for upper atmosphere (n_gpt, n_η, n_t_ref)\nsolar_src_scaled\nrelative solar source contribution from each g-point (n_gpt)\n\n\n\n\n\n","category":"type"},{"location":"optics/LookUpTables/#RRTMGP.LookUpTables.LookUpCld","page":"Lookup Tables","title":"RRTMGP.LookUpTables.LookUpCld","text":"LookUpCld{I,FT,FTA1D,FTA2D,FTA3D,FTA4D}\n\nLookup table for cloud optics.\n\nThis struct stores the tables and Pade coefficients for determing extinction coeffient,  single-scattering albedo, and asymmetry parameter g as a function of effective radius. We compute the optical depth tau (=exintinction coeff * condensed water path) and the products taussa and taussa*g for liquid and ice cloud separately. These are used to determine the optical properties of ice and water cloud together.\n\nFields\n\nnband\nnumber of bands\nnrghice\nnumber of ice roughness types\nnsize_liq\nnumber of liquid particle sizes\nnsize_ice\nnumber of ice particle sizes\nnsizereg\nnumber of size regimes\nncoeff_ext\nnumber of extinction coefficients for pade approximation\nncoeff_ssa_g\nnumber of ssa/g coefficients for pade approximation\nnbound\nnumber of size regime boundaries for pade interpolation\npair\npair = 2\nradliq_lwr\nliquid particle size lower bound for LUT interpolation\nradliq_upr\nliquid particle size upper bound for LUT interpolation\nradliq_fac\nfactor for calculating LUT interpolation for liquid particle\nradice_lwr\nice particle size lower bound for LUT interpolation\nradice_upr\nice particle size upper bound for LUT interpolation\nradice_fac\nfactor for calculating LUT interpolation for ice particle\nlut_extliq\nLUT liquid extinction coefficient (nsize_liq, nbnd) m²/g\nlut_ssaliq\nLUT liquid single scattering albedo (nsize_liq, nbnd)\nlut_asyliq\nLUT liquid asymmetry parameter (nsize_liq, nbnd)\nlut_extice\nLUT ice extinction coefficient (nsize_ice, nband, nrghice) m²/g\nlut_ssaice\nLUT ice single scattering albedo (nsize_ice, nband, nrghice)\nlut_asyice\nLUT ice asymmetry parameter (nsize_ice, nband, nrghice)\npade_extliq\npade coefficients for liquid extinction (nband, nsizereg, ncoeff_ext)\npade_ssaliq\npade coefficients for liquid single scattening albedo (nband, nsizereg, ncoeff_ssa_g)\npade_asyliq\npade coefficients for liquid asymmetry paramter (nband, nsizereg, ncoeff_ssa_g)\npade_extice\npade coefficients for ice extinction (nband, nsizereg, ncoeff_ext, nrghice)\npade_ssaice\npade coefficients for ice single scattening albedo (nband, nsizereg, ncoeff_ssa_g, nrghice)\npade_asyice\npade coefficients for ice asymmetry paramter (nband, nsizereg, ncoeff_ssa_g, nrghice)\npade_sizreg_extliq\npade size regime boundaries for liquid extinction coefficient for pade interpolation (nbound) μm\npade_sizreg_ssaliq\npade size regime boundaries for liquid single scattering albedo for pade interpolation (nbound) μm\npade_sizreg_asyliq\npade size regime boundaries for liquid asymmetry parameter for pade interpolation (nbound) μm\npade_sizreg_extice\npade size regime boundaries for ice extinction coefficient for pade interpolation (nbound) μm\npade_sizreg_ssaice\npade size regime boundaries for ice single scattering albedo for pade interpolation (nbound) μm\npade_sizreg_asyice\npade size regime boundaries for ice asymmetry parameter for pade interpolation (nbound) μm\nbnd_lims_wn\nbeginning and ending wavenumber for each band (2, nband) cm⁻¹\nuse_lut\nuse LUT (default) or pade interpolation\n\n\n\n\n\n","category":"type"},{"location":"optics/LookUpTables/#RRTMGP.LookUpTables.AbstractLookUp","page":"Lookup Tables","title":"RRTMGP.LookUpTables.AbstractLookUp","text":"AbstractLookUp{I,FT}\n\nAbstract lookup table for longwave and shortwave problems.\n\n\n\n\n\n","category":"type"},{"location":"optics/RTE/#Solver","page":"Solver struct","title":"Solver","text":"","category":"section"},{"location":"optics/RTE/","page":"Solver struct","title":"Solver struct","text":"CurrentModule = RRTMGP.RTE","category":"page"},{"location":"optics/RTE/","page":"Solver struct","title":"Solver struct","text":"Solver","category":"page"},{"location":"optics/RTE/#RRTMGP.RTE.Solver","page":"Solver struct","title":"RRTMGP.RTE.Solver","text":"struct Solver{\n    FT,\n    I,\n    FTA1D,\n    FTA2D,\n    AS,\n    OP,\n    SL,\n    SS,\n    BCL,\n    BCS,\n    FXBL,\n    FXBS,\n    FXL,\n    FXS,\n}\n\nThe high-level RRTMGP data structure storing the atmospheric state,  optical properties, sources, boundary conditions and fluxes configurations for a given simulation.\n\nFields\n\nas\nop\nsrc_lw\nsrc_sw\nbcs_lw\nbcs_sw\nfluxb_lw\nfluxb_sw\nflux_lw\nflux_sw\n\n\n\n\n\n","category":"type"},{"location":"optics/BCs/#Boundary-Conditions","page":"Boundary Conditions","title":"Boundary Conditions","text":"","category":"section"},{"location":"optics/BCs/","page":"Boundary Conditions","title":"Boundary Conditions","text":"CurrentModule = RRTMGP.BCs","category":"page"},{"location":"optics/BCs/","page":"Boundary Conditions","title":"Boundary Conditions","text":"LwBCs\nSwBCs","category":"page"},{"location":"optics/BCs/#RRTMGP.BCs.LwBCs","page":"Boundary Conditions","title":"RRTMGP.BCs.LwBCs","text":"LwBCs{FT,FTA1D,FTA2DN}\n\nLongwave boundary conditions\n\nFields\n\nsfc_emis\nSurface emissivity [W/m²] (nbnd, ncol)\ninc_flux\nincident flux at top of atmosphere [W/m²] (ncol, ngpt)\n\n\n\n\n\n","category":"type"},{"location":"optics/BCs/#RRTMGP.BCs.SwBCs","page":"Boundary Conditions","title":"RRTMGP.BCs.SwBCs","text":"SwBCs{FT,FTA1D}\n\nShortwave boundary conditions\n\nFields\n\nzenith\nzenith angle (ncol)\ntoa_flux\ntop of atmosphere flux (ncol)\nsfc_alb_direct\nsurface albedo for specular (direct) radiation (nbnd, ncol)\ninc_flux_diffuse\nincident diffuse flux at top of domain [W/m2] (ncol, ngpt)\nsfc_alb_diffuse\nsurface albedo for diffuse radiation (nbnd, ncol)\n\n\n\n\n\n","category":"type"},{"location":"optics/AtmosphericStates/#Atmospheric-State","page":"Atmospheric State","title":"Atmospheric State","text":"","category":"section"},{"location":"optics/AtmosphericStates/","page":"Atmospheric State","title":"Atmospheric State","text":"CurrentModule = RRTMGP.AtmosphericStates","category":"page"},{"location":"optics/AtmosphericStates/","page":"Atmospheric State","title":"Atmospheric State","text":"AtmosphericState\nGrayAtmosphericState","category":"page"},{"location":"optics/AtmosphericStates/#RRTMGP.AtmosphericStates.AtmosphericState","page":"Atmospheric State","title":"RRTMGP.AtmosphericStates.AtmosphericState","text":"AtmosphericState{FT,FTA1D,FTA1DN,FTA2D,CLDP,CLDM,VMR,I} <:\n    AbstractAtmosphericState{FT,I,FTA1D}\n\nAtmospheric conditions, used to compute optical properties. \n\nFields\n\nlon\nlongitude (ncol), optional\nlat\nlatitude (ncol), optional\np_lay\nLayer pressures [Pa, mb]; (nlay,ncol)\np_lev\nLevel pressures [Pa, mb]; (nlay+1,ncol)\nt_lay\nLayer temperatures [K]; (nlay,ncol)\nt_lev\nLevel temperatures [K]; (nlay+1,ncol)\nt_sfc\nSurface temperatures [K]; (ncol)\ncol_dry\nNumber of molecules per cm^2 of dry air (nlay, ncol)\nvmr\nvolume mixing ratio of all relevant gases\ncld_r_eff_liq\neffective radius of cloud liquid particles\ncld_r_eff_ice\neffective radius of cloud ice particles\ncld_path_liq\ncloud water path\ncld_path_ice\ncloud ice path\ncld_mask_lw\ncloud mask (longwave), = true if clouds are present\ncld_mask_sw\ncloud mask (shortwave), = true if clouds are present\nice_rgh\nice roughness, 1 = none, 2 = medium, 3 = rough\nnlay\nNumber of layers.\nncol\nNumber of columns.\nngas\nNumber of gases.\n\n\n\n\n\n","category":"type"},{"location":"optics/AtmosphericStates/#RRTMGP.AtmosphericStates.GrayAtmosphericState","page":"Atmospheric State","title":"RRTMGP.AtmosphericStates.GrayAtmosphericState","text":"GrayAtmosphericState{FT,FTA1D,FTA2D,I} <: \n    AbstractAtmosphericState{FT,I,FTA1D}\n\nAtmospheric conditions, used to compute optical properties with the gray atmosphere approximation\n\nFields\n\np_lay\nLayer pressures [Pa, mb]; (nlay, ncol)\np_lev\nLevel pressures [Pa, mb]; (nlay+1, ncol)\nt_lay\nLayer temperatures [K]; (nlay, ncol)\nt_lev\nLevel temperatures [K]; (nlay+1,ncol)\nz_lev\nLevel Altitude [m]; (nlay+1,ncol)\nt_sfc\nSurface temperatures [K]; (ncol)\nα\nlapse rate\nd0\noptical thickness parameter\nnlay\nNumber of layers.\nncol\nNumber of columns.\n\n\n\n\n\n","category":"type"},{"location":"optics/Vmrs/#Volume-Mixing-Ratios","page":"Volume Mixing Ratios","title":"Volume Mixing Ratios","text":"","category":"section"},{"location":"optics/Vmrs/","page":"Volume Mixing Ratios","title":"Volume Mixing Ratios","text":"CurrentModule = RRTMGP.Vmrs","category":"page"},{"location":"optics/Vmrs/","page":"Volume Mixing Ratios","title":"Volume Mixing Ratios","text":"AbstractVmr\nVmr\nVmrGM\ninit_vmr\nget_vmr","category":"page"},{"location":"optics/Vmrs/#RRTMGP.Vmrs.AbstractVmr","page":"Volume Mixing Ratios","title":"RRTMGP.Vmrs.AbstractVmr","text":"AbstractVmr{FT}\n\n\n\n\n\n","category":"type"},{"location":"optics/Vmrs/#RRTMGP.Vmrs.Vmr","page":"Volume Mixing Ratios","title":"RRTMGP.Vmrs.Vmr","text":"Vmr{FT,FTA3D} <: AbstractVmr{FT}\n\nVolume mixing ratios for various gases in the atmosphere. This struct can be used when concentrations vary spatially for all gases.\n\nFields\n\nvmr\nvolume mixing ratio of all gases as a function of location and column\n\n\n\n\n\n","category":"type"},{"location":"optics/Vmrs/#RRTMGP.Vmrs.VmrGM","page":"Volume Mixing Ratios","title":"RRTMGP.Vmrs.VmrGM","text":"VmrGM{FT,FTA1D,FTA2D} <: AbstractVmr{FT}\n\nVolume mixing ratios for various gases in the atmosphere. This struct can be used when only H₂O and O₃ concentrations vary spatially and a global mean is used  for all other gases.\n\nFields\n\nvmr_h2o\nvolume mixing ratio of H₂O\nvmr_o3\nvolume mixing ratio of Ozone\nvmr\nvolume mixing ratio of all other gases, which are independent of location and column\n\n\n\n\n\n","category":"type"},{"location":"optics/Vmrs/#RRTMGP.Vmrs.init_vmr","page":"Volume Mixing Ratios","title":"RRTMGP.Vmrs.init_vmr","text":"init_vmr(\n    ngas,\n    nlay,\n    ncol,\n    ::Type{FT},\n    ::Type{DA};\n    gm::Bool = true,\n) where {FT<:AbstractFloat,DA}\n\nInitialize the Vmr struct.\n\n\n\n\n\n","category":"function"},{"location":"optics/Vmrs/#RRTMGP.Vmrs.get_vmr","page":"Volume Mixing Ratios","title":"RRTMGP.Vmrs.get_vmr","text":"get_vmr(\n    vmr::VmrGM{FT},\n    ig::Int,\n    ilay::Int,\n    icol::Int,\n) where {FT<:AbstractFloat}\n\nObtain volume mixing ratio of gas ig for layer ilay of column icol.\n\n\n\n\n\nget_vmr(\n    vmr::Vmr{FT},\n    ig::Int,\n    ilay::Int,\n    icol::Int,\n) where {FT<:AbstractFloat}\n\nObtain volume mixing ratio of gas ig for layer ilay of column icol.\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#Optics","page":"Optics","title":"Optics","text":"","category":"section"},{"location":"optics/Optics/","page":"Optics","title":"Optics","text":"CurrentModule = RRTMGP.Optics","category":"page"},{"location":"optics/Optics/","page":"Optics","title":"Optics","text":"AbstractOpticalProps\nOneScalar\nTwoStream\ncompute_col_dry!\ncompute_optical_props!","category":"page"},{"location":"optics/Optics/#RRTMGP.Optics.AbstractOpticalProps","page":"Optics","title":"RRTMGP.Optics.AbstractOpticalProps","text":"AbstractOpticalProps{FT,FTA2D}\n\nOptical properties for one scalar and two stream calculations.\n\n\n\n\n\n","category":"type"},{"location":"optics/Optics/#RRTMGP.Optics.OneScalar","page":"Optics","title":"RRTMGP.Optics.OneScalar","text":"OneScalar{FT,FTA1D,FTA2D,I,AD} <: AbstractOpticalProps{FT,FTA2D}\n\nSingle scalar approximation for optical depth, used in calculations accounting for extinction and emission\n\nFields\n\nτ\nOptical Depth\nangle_disc\nAngular discretization\n\n\n\n\n\n","category":"type"},{"location":"optics/Optics/#RRTMGP.Optics.TwoStream","page":"Optics","title":"RRTMGP.Optics.TwoStream","text":"TwoStream{FT,FTA2D} <: AbstractOpticalProps{FT,FTA2D}\n\nTwo stream approximation for optical properties, used in calculations accounting for extinction and emission\n\nFields\n\nτ\nOptical depth\nssa\nSingle-scattering albedo\ng\nAsymmetry parameter\n\n\n\n\n\n","category":"type"},{"location":"optics/Optics/#RRTMGP.Optics.compute_col_dry!","page":"Optics","title":"RRTMGP.Optics.compute_col_dry!","text":"compute_col_dry!(\n    p_lev,\n    col_dry,\n    param_set,\n    vmr_h2o,\n    lat,\n    max_threads = Int(256),\n)\n\nThis function computes the column amounts of dry or moist air.\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#RRTMGP.Optics.compute_optical_props!","page":"Optics","title":"RRTMGP.Optics.compute_optical_props!","text":"compute_optical_props!(\n    op::AbstractOpticalProps{FT},\n    as::AtmosphericState{FT},\n    sf::AbstractSourceLW{FT},\n    gcol::I,\n    igpt::I,\n    lkp::LookUpLW{I,FT},\n    lkp_cld::Union{LookUpCld,Nothing} = nothing,\n) where {I<:Int,FT<:AbstractFloat}\n\nComputes optical properties for the longwave problem.\n\n\n\n\n\ncompute_optical_props!(\n    op::AbstractOpticalProps{FT},\n    as::AtmosphericState{FT},\n    gcol::I,\n    igpt::I,\n    lkp::LookUpSW{I,FT},\n    lkp_cld::Union{LookUpCld,Nothing} = nothing,\n) where {I<:Int,FT<:AbstractFloat}\n\nComputes optical properties for the shortwave problem.\n\n\n\n\n\ncompute_optical_props!(\n    op::AbstractOpticalProps{FT},\n    as::GrayAtmosphericState{FT},\n    sf::AbstractSourceLW{FT},\n    gcol::I,\n    igpt::I = 1,\n) where {FT<:AbstractFloat}\n\nComputes optical properties for the longwave gray radiation problem.\n\n\n\n\n\ncompute_optical_props!(\n    op::AbstractOpticalProps{FT},\n    as::GrayAtmosphericState{FT},\n    gcol::I,\n    igpt::I = 1,\n) where {FT<:AbstractFloat}\n\nComputes optical properties for the shortwave gray radiation problem.\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/","page":"Optics","title":"Optics","text":"compute_col_dry_kernel!\ncompute_interp_fractions\ncompute_interp_frac_temp\ncompute_interp_frac_press\ncompute_interp_frac_η\ncompute_τ_ssa_lw_src!\ncompute_τ_minor\ncompute_τ_rayleigh\ncompute_lw_planck_src!","category":"page"},{"location":"optics/Optics/#RRTMGP.Optics.compute_col_dry_kernel!","page":"Optics","title":"RRTMGP.Optics.compute_col_dry_kernel!","text":"compute_col_dry_kernel!(\n    col_dry,\n    p_lev,\n    mol_m_dry,\n    mol_m_h2o,\n    avogadro\n    helmert1,\n    vmr_h2o\n    lat,\n    glaycol,\n)\n\nThis function computes the column amounts of dry or moist air.\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#RRTMGP.Optics.compute_interp_fractions","page":"Optics","title":"RRTMGP.Optics.compute_interp_fractions","text":"compute_interp_fractions(\n    lkp::AbstractLookUp{I,FT},\n    vmr,\n    p_lay,\n    t_lay,\n    tropo,\n    ibnd,\n    glaycol,\n) where {I<:Int,FT<:AbstractFloat}\n\ncompute interpolation fractions for binary species parameter, pressure and temperature.\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#RRTMGP.Optics.compute_interp_frac_temp","page":"Optics","title":"RRTMGP.Optics.compute_interp_frac_temp","text":"compute_interp_frac_temp(\n    lkp::AbstractLookUp{I,FT},\n    t_lay,\n    glay,\n    gcol,\n) where {I<:Int,FT<:AbstractFloat}\n\ncompute interpolation fraction for temperature.\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#RRTMGP.Optics.compute_interp_frac_press","page":"Optics","title":"RRTMGP.Optics.compute_interp_frac_press","text":"compute_interp_frac_press(\n    lkp::AbstractLookUp,\n    p_lay,\n    tropo,\n    glay,\n    gcol,\n)\n\nCompute interpolation fraction for pressure.\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#RRTMGP.Optics.compute_interp_frac_η","page":"Optics","title":"RRTMGP.Optics.compute_interp_frac_η","text":"compute_interp_frac_η(\n    lkp::AbstractLookUp{I,FT},\n    vmr,\n    tropo,\n    jtemp,\n    ibnd,\n    glay,\n    gcol,\n) where {FT<:AbstractFloat,I<:Int}\n\nCompute interpolation fraction for binary species parameter.\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#RRTMGP.Optics.compute_τ_ssa_lw_src!","page":"Optics","title":"RRTMGP.Optics.compute_τ_ssa_lw_src!","text":"compute_τ_ssa_lw_src!(\n    lkp::AbstractLookUp{I,FT},\n    vmr,\n    col_dry,\n    igpt,\n    ibnd,\n    p_lay::FT,\n    t_lay,\n    glaycol,\n    src_args...,\n) where {FT<:AbstractFloat,I<:Int}\n\nCompute optical thickness, single scattering albedo, asymmetry parameter  and longwave sources whenever applicable.\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#RRTMGP.Optics.compute_τ_minor","page":"Optics","title":"RRTMGP.Optics.compute_τ_minor","text":"compute_τ_minor(\n    lkp::AbstractLookUp,\n    tropo::I,\n    vmr,\n    vmr_h2o::FT,\n    col_dry,\n    p_lay::FT,\n    t_lay::FT,\n    jtemp::I,\n    ftemp::FT,\n    jη1::I,\n    jη2::I,\n    fη1::FT,\n    fη2::FT,\n    igpt,\n    ibnd,\n    glay,\n    gcol,\n) where {FT<:AbstractFloat,I<:Int}\n\nCompute optical thickness contributions from minor gases.\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#RRTMGP.Optics.compute_τ_rayleigh","page":"Optics","title":"RRTMGP.Optics.compute_τ_rayleigh","text":"compute_τ_rayleigh(\n    lkp::LookUpSW,\n    tropo::I,\n    col_dry::FT,\n    vmr_h2o::FT,\n    jtemp::I,\n    ftemp::FT,\n    jη1::I,\n    jη2::I,\n    fη1::FT,\n    fη2::FT,\n    igpt::I,\n) where {FT<:AbstractFloat,I<:Int}\n\nCompute Rayleigh scattering optical depths for shortwave problem\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#RRTMGP.Optics.compute_lw_planck_src!","page":"Optics","title":"RRTMGP.Optics.compute_lw_planck_src!","text":"compute_lw_planck_src!(\n    lkp::LookUpLW,\n    jη1,\n    jη2,\n    fη1,\n    fη2,\n    jpresst,\n    fpress,\n    jtemp,\n    ftemp,\n    t_lay,\n    igpt,\n    ibnd,\n    glay,\n    gcol,\n    sf,\n    t_lev,\n    t_sfc,\n)\n\nComputes Planck sources for the longwave problem.\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/","page":"Optics","title":"Optics","text":"add_cloud_optics_2stream\ncompute_cld_props\npade_eval","category":"page"},{"location":"optics/Optics/#RRTMGP.Optics.add_cloud_optics_2stream","page":"Optics","title":"RRTMGP.Optics.add_cloud_optics_2stream","text":"add_cloud_optics_2stream(\n    op::TwoStream,\n    as::AtmosphericState,\n    lkp::LookUpLW,\n    lkp_cld,\n    glaycol,\n    ibnd,\n    igpt,\n)\n\nThis function computes the longwave TwoStream clouds optics properties and adds them to the TwoStream longwave gas optics properties.\n\n\n\n\n\nadd_cloud_optics_2stream(\n    op::TwoStream,\n    as::AtmosphericState,\n    lkp::LookUpSW,\n    lkp_cld,\n    glaycol,\n    ibnd,\n    igpt,\n)\n\nThis function computes the longwave TwoStream clouds optics properties and adds them to the TwoStream shortwave gase optics properties.\n\n\n\n\n\nadd_cloud_optics_2stream(op::OneScalar, args...)\n\nCloud optics is currently only supported for the TwoStream solver.\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#RRTMGP.Optics.compute_cld_props","page":"Optics","title":"RRTMGP.Optics.compute_cld_props","text":"compute_cld_props(lkp_cld, as, glay, gcol, ibnd, igpt)\n\nThis function computed the TwoSteam cloud optics properties using either the  lookup table method or pade method.\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#RRTMGP.Optics.pade_eval","page":"Optics","title":"RRTMGP.Optics.pade_eval","text":"pade_eval(\n    ibnd,\n    re,\n    irad,\n    m,\n    n,\n    pade_coeffs,\n    irgh::Union{Int,Nothing} = nothing,\n)\n\nEvaluate Pade approximant of order [m/n]\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/","page":"Optics","title":"Optics","text":"compute_optical_props_kernel!\ncompute_sources_gray_kernel!","category":"page"},{"location":"optics/Optics/#RRTMGP.Optics.compute_optical_props_kernel!","page":"Optics","title":"RRTMGP.Optics.compute_optical_props_kernel!","text":"compute_optical_props_kernel!(\n    op::AbstractOpticalProps{FT},\n    as::GrayAtmosphericState{FT},\n    glaycol,\n    source::AbstractSourceLW{FT},\n) where {FT<:AbstractFloat}\n\nThis function computes the optical properties using the gray atmosphere assumption for the longwave solver.\n\n\n\n\n\ncompute_optical_props_kernel!(\n    op::AbstractOpticalProps{FT},\n    as::GrayAtmosphericState{FT},\n    glaycol,\n) where {FT<:AbstractFloat}\n\nThis function computes the optical properties using the gray atmosphere assumption for the shortwave solver.\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#RRTMGP.Optics.compute_sources_gray_kernel!","page":"Optics","title":"RRTMGP.Optics.compute_sources_gray_kernel!","text":"compute_sources_gray_kernel!(\n    source::AbstractSourceLW{FT},\n    as::GrayAtmosphericState{FT},\n    glaycol,\n) where {FT<:AbstractFloat}\n\nThis function computes the Planck sources for the gray longwave solver.\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/","page":"Optics","title":"Optics","text":"interp1d\ninterp2d\ninterp3d\nincrement!\ndelta_scale","category":"page"},{"location":"optics/Optics/#RRTMGP.Optics.interp1d","page":"Optics","title":"RRTMGP.Optics.interp1d","text":"interp1d(xi::FT, x, y, col) where {FT<:AbstractFloat}\n\nperform 1D linear interpolation.\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#RRTMGP.Optics.interp2d","page":"Optics","title":"RRTMGP.Optics.interp2d","text":"interp2d(\n    fη1::FT,\n    fη2::FT,\n    ftemp::FT,\n    coeff::FTA3D,\n    igpt::I,\n    jη1::I,\n    jη2::I,\n    jtemp::I,\n) where {FT<:AbstractFloat,FTA3D<:AbstractArray{FT,3},I<:Int}\n\nPerform 2D linear interpolation.\n\nfminor[1, 1] = (FT(1) - fη1) * (1-ftemp)\n\nfminor[2, 1] = fη1 * (1-ftemp)\n\nfminor[1, 2] = (FT(1) - fη2) * ftemp\n\nfminor[2, 2] = fη2 * ftemp\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#RRTMGP.Optics.interp3d","page":"Optics","title":"RRTMGP.Optics.interp3d","text":"interp3d(\n    jη1::I,\n    jη2::I,\n    fη1::FT,\n    fη2::FT,\n    jtemp::I,\n    ftemp::FT,\n    jpresst::I,\n    fpress::FT,\n    coeff::FTA4D,\n    igpt::I,\n    s1::FT = FT(1),\n    s2::FT = FT(1),\n) where {FT<:AbstractFloat,FTA4D<:AbstractArray{FT,4},I<:Int}\n\nPerform 3D linear interpolation.\n\nfmajor[1, 1, itemp] = (FT(1) - fpress) * fminor[1, itemp]\n\nfmajor[2, 1, itemp] = (FT(1) - fpress) * fminor[2, itemp]\n\nfmajor[1, 2, itemp] = fpress * fminor[1, itemp]\n\nfmajor[2, 2, itemp] = fpress * fminor[2, itemp]\n\nwhere,\n\nfminor[1, itemp=1] = (FT(1) - fη1) * (1-ftemp)\n\nfminor[2, itemp=1] = fη1 * (1-ftemp)\n\nfminor[1, itemp=2] = (FT(1) - fη2) * ftemp\n\nfminor[2, itemp=2] = fη2 * ftemp\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#RRTMGP.Optics.increment!","page":"Optics","title":"RRTMGP.Optics.increment!","text":"increment!(\n    op::TwoStream{FT},\n    τ2,\n    ssa2,\n    g2,\n    glay,\n    gcol,\n    igpt,\n) where {FT<:AbstractFloat}\n\nIncrement TwoStream optical properties op for layer glay  and column gcol with optical thickness τ2, single scattering albedo ssa2 and symmetry parameter g2.\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#RRTMGP.Optics.delta_scale","page":"Optics","title":"RRTMGP.Optics.delta_scale","text":"delta_scale(τ, ssa, g)\n\ndelta-scale two stream optical properties.\n\n\n\n\n\n","category":"function"},{"location":"References/#References","page":"References","title":"References","text":"","category":"section"},{"location":"References/#Scattering","page":"References","title":"Scattering","text":"","category":"section"},{"location":"References/","page":"References","title":"References","text":"Costa, S. M. S., & Shine, K. P. (2006, April). An estimate of the global impact of multiple scattering by clouds on outgoing long-wave radiation. Quart. J. Royal Met. Soc., 132(616), 885–895.","category":"page"},{"location":"References/","page":"References","title":"References","text":"Kuo, C.P., Yang, P., Huang, X., Feldman, D., Flanner, M., Kuo, C., & Mlawer, E. J. (2017, December). Impact of Multiple Scattering on Longwave Radiative Transfer Involving Clouds. J. Adv. Model. Earth Syst., 9(8), 3082–3098.","category":"page"},{"location":"References/#Two-stream","page":"References","title":"Two-stream","text":"","category":"section"},{"location":"References/","page":"References","title":"References","text":"Meador, W. E., & Weaver, W. R. (1980). Two-Stream Approximations to Radiative Transfer in Planetary Atmospheres: A Unified Description of Existing Methods and a New Improvement. J. Atmos. Sci., 37(3), 630–643.","category":"page"},{"location":"References/#Transport","page":"References","title":"Transport","text":"","category":"section"},{"location":"References/","page":"References","title":"References","text":"Shonk, J. K. P., & Hogan, R. J. (2008, June). Tripleclouds: An Efficient Method for Representing Horizontal Cloud Inhomogeneity in 1D Radiation Schemes by Using Three Regions at Each Height. J. Climate, 21(11), 2352–2370.","category":"page"},{"location":"References/#Longwave-and-Shortwave","page":"References","title":"Longwave & Shortwave","text":"","category":"section"},{"location":"References/","page":"References","title":"References","text":"Fu, Q., & Liou, K. N. (1992). On the correlated k-distribution method for radiative transfer in nonhomogeneous atmospheres. J. Atmos. Sci., 49(22), 2139–2156.","category":"page"},{"location":"References/","page":"References","title":"References","text":"Fu, Q., Liou, K. N., Cribb, M. C., Charlock, T. P., & Grossman, A. (1997, December). Multiple Scattering Parameterization in Thermal Infrared Radiative Transfer. J. Atmos. Sci., 54(24), 2799–2812.","category":"page"},{"location":"References/","page":"References","title":"References","text":"Clough, S. A., Iacono, M. J., & Moncet, J.L. (1992). Line-by-line calculations of atmospheric fluxes and cooling rates: Application to water vapor. J. Geophys. Res., 97(D14), 15761–15785.","category":"page"},{"location":"References/","page":"References","title":"References","text":"Zdunkowski, W. G., Welch, R. M., & Korb, G. J. (1980, September). An investigation of the structure of typical two-stream methods for the calculation of solar fluxes and heating rates in clouds. Beitr ̈age zur Physik Atmosph ̈ere , 53 , 147–166.","category":"page"},{"location":"optics/AngularDiscretizations/#Angular-Discretizations","page":"Angular Discretization","title":"Angular Discretizations","text":"","category":"section"},{"location":"optics/AngularDiscretizations/","page":"Angular Discretization","title":"Angular Discretization","text":"CurrentModule = RRTMGP.AngularDiscretizations","category":"page"},{"location":"optics/AngularDiscretizations/","page":"Angular Discretization","title":"Angular Discretization","text":"AngularDiscretization","category":"page"},{"location":"optics/AngularDiscretizations/#RRTMGP.AngularDiscretizations.AngularDiscretization","page":"Angular Discretization","title":"RRTMGP.AngularDiscretizations.AngularDiscretization","text":"AngularDiscretization{FT,FTA1D,I}\n\nWeights and angle secants for first order (k=1) Gaussian quadrature. Values from Table 2, Clough et al, 1992, doi:10.1029/92JD01419 after Abramowitz & Stegun 1972, page 921\n\nFields\n\nn_gauss_angles\nnumber of quadrature angles\ngauss_Ds\nquadrature secants / secant of propagation angle\ngauss_wts\nquadrature weights\n\n\n\n\n\n","category":"type"},{"location":"RTESolver/#RTE-Solver","page":"RTE Solver","title":"RTE Solver","text":"","category":"section"},{"location":"RTESolver/","page":"RTE Solver","title":"RTE Solver","text":"CurrentModule = RRTMGP.RTESolver","category":"page"},{"location":"RTESolver/","page":"RTE Solver","title":"RTE Solver","text":"solve_lw!\nrte_lw_noscat_solve!\nrte_lw_2stream_solve!\nsolve_sw!\nrte_sw_noscat_solve!\nrte_sw_2stream_solve!","category":"page"},{"location":"RTESolver/#RRTMGP.RTESolver.solve_lw!","page":"RTE Solver","title":"RRTMGP.RTESolver.solve_lw!","text":"solve_lw!(\n    slv::Solver{FT,I},\n    max_threads::I,\n    lkp_args...,\n) where {I<:Int,FT<:AbstractFloat}\n\nSolver for the longwave radiation problem\n\n\n\n\n\n","category":"function"},{"location":"RTESolver/#RRTMGP.RTESolver.rte_lw_noscat_solve!","page":"RTE Solver","title":"RRTMGP.RTESolver.rte_lw_noscat_solve!","text":"rte_lw_noscat_solve!(\n    flux::FluxLW{FT},\n    flux_lw::FluxLW{FT},\n    src_lw::SourceLWNoScat{FT},\n    bcs_lw::LwBCs{FT},\n    op::OneScalar{FT},\n    nlay,\n    ncol,\n    major_gpt2bnd::AbstractArray{UInt8,1},\n    max_threads,\n    as::AbstractAtmosphericState{FT},\n    lkp_args...,\n) where {FT<:AbstractFloat}\n\nNo scattering solver for the longwave problem. LW fluxes, no scattering, mu (cosine of integration angle) specified by column Does radiation calculation at user-supplied angles; converts radiances to flux using user-supplied weights. Currently, only ngaussangles = 1 supported.\n\n\n\n\n\n","category":"function"},{"location":"RTESolver/#RRTMGP.RTESolver.rte_lw_2stream_solve!","page":"RTE Solver","title":"RRTMGP.RTESolver.rte_lw_2stream_solve!","text":"rte_lw_2stream_solve!(\n    flux::FluxLW{FT},\n    flux_lw::FluxLW{FT},\n    src_lw::SourceLW2Str{FT},\n    bcs_lw::LwBCs{FT},\n    op::TwoStream{FT},\n    nlay,\n    ncol,\n    major_gpt2bnd::AbstractArray{UInt8,1},\n    max_threads,\n    as::AbstractAtmosphericState{FT},\n    lkp_args...,\n) where {FT<:AbstractFloat}\n\nTwo stream solver for the longwave problem.\n\nRRTMGP provides source functions at each level using the spectral mapping of each adjacent layer. Combine these for two-stream calculations lw combine sources (rtelw2streamcombinesources!) combine RRTMGP-specific sources at levels compute layer reflectance, transmittance compute total source function at levels using linear-in-tau (rtelw2streamsource!) transport (addinglw!)\n\n\n\n\n\n","category":"function"},{"location":"RTESolver/#RRTMGP.RTESolver.solve_sw!","page":"RTE Solver","title":"RRTMGP.RTESolver.solve_sw!","text":"solve_sw!(\n    slv::Solver{FT,I},\n    max_threads::I,\n    lkp_args...,\n) where {I<:Int,FT<:AbstractFloat}\n\nSolver for the shortwave radiation problem\n\n\n\n\n\n","category":"function"},{"location":"RTESolver/#RRTMGP.RTESolver.rte_sw_noscat_solve!","page":"RTE Solver","title":"RRTMGP.RTESolver.rte_sw_noscat_solve!","text":"rte_sw_noscat_solve!(\n    flux::FluxSW{FT},\n    flux_sw::FluxSW{FT},\n    op::OneScalar{FT},\n    bcs_sw::SwBCs{FT},\n    nlay,\n    ncol,\n    solar_src_scaled::AbstractArray{FT,1},\n    max_threads,\n    as::AbstractAtmosphericState{FT},\n    lkp_args...,\n) where {FT<:AbstractFloat}\n\nNo-scattering solver for the shortwave problem. (Extinction-only i.e. solar direct beam)\n\n\n\n\n\n","category":"function"},{"location":"RTESolver/#RRTMGP.RTESolver.rte_sw_2stream_solve!","page":"RTE Solver","title":"RRTMGP.RTESolver.rte_sw_2stream_solve!","text":"rte_sw_2stream_solve!(\n    flux::FluxSW{FT},\n    flux_sw::FluxSW{FT},\n    op::TwoStream{FT},\n    bcs_sw::SwBCs{FT},\n    src_sw::SourceSW2Str{FT},\n    nlay,\n    ncol,\n    major_gpt2bnd::AbstractArray{UInt8,1},\n    solar_src_scaled::AbstractArray{FT,1},\n    max_threads,\n    as::AbstractAtmosphericState{FT},\n    lkp_args...,\n) where {FT<:AbstractFloat}\n\nTwo stream solver for the shortwave problem.\n\n\n\n\n\n","category":"function"},{"location":"RTESolver/","page":"RTE Solver","title":"RTE Solver","text":"rte_lw_noscat_source!\nrte_lw_noscat_transport!\nrte_lw_2stream_combine_sources!\nrte_lw_2stream_source!\nadding_lw!\nrte_sw_noscat_solve_kernel!\nsw_two_stream!\nsw_source_2str!\nadding_sw!","category":"page"},{"location":"RTESolver/#RRTMGP.RTESolver.rte_lw_noscat_source!","page":"RTE Solver","title":"RRTMGP.RTESolver.rte_lw_noscat_source!","text":"rte_lw_noscat_source!(\n    src_lw::SourceLWNoScat{FT},\n    op::OneScalar{FT},\n    gcol,\n    nlay,\n) where {FT<:AbstractFloat}\n\nCompute LW source function for upward and downward emission at levels using linear-in-tau assumption See Clough et al., 1992, doi: 10.1029/92JD01419, Eq 13\n\n\n\n\n\n","category":"function"},{"location":"RTESolver/#RRTMGP.RTESolver.rte_lw_noscat_transport!","page":"RTE Solver","title":"RRTMGP.RTESolver.rte_lw_noscat_transport!","text":"rte_lw_noscat_transport!(\n    src_lw::SourceLWNoScat{FT},\n    bcs_lw::LwBCs{FT},\n    op::OneScalar{FT},\n    gcol,\n    flux::FluxLW{FT},\n    igpt,\n    ibnd,\n    nlay,\n    nlev,\n) where {FT<:AbstractFloat}\n\nTransport for no-scattering longwave problem.\n\n\n\n\n\n","category":"function"},{"location":"RTESolver/#RRTMGP.RTESolver.rte_lw_2stream_combine_sources!","page":"RTE Solver","title":"RRTMGP.RTESolver.rte_lw_2stream_combine_sources!","text":"rte_lw_2stream_combine_sources!(src::SourceLW2Str, gcol, nlev, ncol)\n\nRRTMGP provides source functions at each level using the spectral mapping of each adjacent layer. This function combines these for two-stream calculations.\n\n\n\n\n\n","category":"function"},{"location":"RTESolver/#RRTMGP.RTESolver.rte_lw_2stream_source!","page":"RTE Solver","title":"RRTMGP.RTESolver.rte_lw_2stream_source!","text":"rte_lw_2stream_source!(\n    op::TwoStream{FT},\n    src_lw::SourceLW2Str{FT},\n    gcol,\n    nlay,\n    ncol,\n) where {FT<:AbstractFloat}\n\nThis function combines RRTMGP-specific sources at levels, computes layer reflectance, transmittance, and total source function at levels using linear-in-tau approximation.\n\n\n\n\n\n","category":"function"},{"location":"RTESolver/#RRTMGP.RTESolver.adding_lw!","page":"RTE Solver","title":"RRTMGP.RTESolver.adding_lw!","text":"adding_lw!(\n    flux::FluxLW{FT},\n    src_lw::SL,\n    bcs_lw::BCL,\n    gcol,\n    igpt,\n    ibnd,\n    nlev,\n    ncol,\n) where {FT<:AbstractFloat,SL<:SourceLW2Str{FT},BCL<:LwBCs{FT}}\n\nTransport of diffuse radiation through a vertically layered atmosphere, for the longwave problem. Equations are after Shonk and Hogan 2008, doi:10.1175/2007JCLI1940.1 (SH08)\n\n\n\n\n\n","category":"function"},{"location":"RTESolver/#RRTMGP.RTESolver.rte_sw_noscat_solve_kernel!","page":"RTE Solver","title":"RRTMGP.RTESolver.rte_sw_noscat_solve_kernel!","text":"rte_sw_noscat_solve_kernel!(\n    flux::FluxSW{FT},\n    op::OneScalar{FT},\n    bcs_sw::SwBCs{FT},\n    solar_frac::FT,\n    gcol,\n    nlev,\n) where {FT<:AbstractFloat}\n\nNo-scattering solver for the shortwave problem. (Extinction-only i.e. solar direct beam)\n\n\n\n\n\n","category":"function"},{"location":"RTESolver/#RRTMGP.RTESolver.sw_two_stream!","page":"RTE Solver","title":"RRTMGP.RTESolver.sw_two_stream!","text":"sw_two_stream!(\n    op::TwoStream{FT},\n    src_sw::SourceSW2Str{FT},\n    bcs_sw::SwBCs{FT},\n    gcol,\n    nlay,\n) where {FT<:AbstractFloat}\n\nComputes cell properties (transmittance and reflectance) for direct and diffuse radiation\n\nTwo-stream solutions to direct and diffuse reflectance and transmittance for a layer with optical depth tau, single scattering albedo w0, and asymmetery parameter g.\n\nEquations are developed in Meador and Weaver, 1980, doi:10.1175/1520-0469(1980)037<0630:TSATRT>2.0.CO;2\n\n\n\n\n\n","category":"function"},{"location":"RTESolver/#RRTMGP.RTESolver.sw_source_2str!","page":"RTE Solver","title":"RRTMGP.RTESolver.sw_source_2str!","text":"sw_source_2str!(\n    src_sw::SourceSW2Str{FT},\n    bcs_sw::SwBCs{FT},\n    gcol,\n    flux::FluxSW{FT},\n    solar_frac::FT,\n    ibnd,\n    nlay,\n) where {FT<:AbstractFloat}\n\nDirect-beam and source for diffuse radiation\n\n\n\n\n\n","category":"function"},{"location":"RTESolver/#RRTMGP.RTESolver.adding_sw!","page":"RTE Solver","title":"RRTMGP.RTESolver.adding_sw!","text":"adding_sw!(\n    src_sw::SourceSW2Str{FT},\n    bcs_sw::SwBCs{FT},\n    gcol,\n    flux::FluxSW{FT},\n    igpt,\n    ibnd,\n    nlev,\n) where {FT<:AbstractFloat}\n\nTransport for the two stream shortwave problem.\n\nTransport of diffuse radiation through a vertically layered atmosphere. Equations are after Shonk and Hogan 2008, doi:10.1175/2007JCLI1940.1 (SH08)\n\n\n\n\n\n","category":"function"},{"location":"optics/Sources/#Source-Functions","page":"Source Functions","title":"Source Functions","text":"","category":"section"},{"location":"optics/Sources/","page":"Source Functions","title":"Source Functions","text":"CurrentModule = RRTMGP.Sources","category":"page"},{"location":"optics/Sources/","page":"Source Functions","title":"Source Functions","text":"AbstractSourceLW\nSourceLWNoScat\nSourceLW2Str\nSourceSW2Str\nsource_func_longwave\nsource_func_shortwave","category":"page"},{"location":"optics/Sources/#RRTMGP.Sources.AbstractSourceLW","page":"Source Functions","title":"RRTMGP.Sources.AbstractSourceLW","text":"AbstractSourceLW{FT,FTA1D,FTA2D}\n\nAbstract longwave source for no-scattering and two stream longwave solvers.\n\n\n\n\n\n","category":"type"},{"location":"optics/Sources/#RRTMGP.Sources.SourceLWNoScat","page":"Source Functions","title":"RRTMGP.Sources.SourceLWNoScat","text":"SourceLWNoScat{FT,FTA1D,FTA2D} <: AbstractSourceLW{FT,FTA1D,FTA2D}\n\nLongwave sources: computed at layer center, layer edges,  and at the surface for no scattering calculations\n\nFields\n\nparam_set\nParameter set\nlay_source\nPlanck source at layer average temperature [W/m2] (nlay, ncol)\nlev_source_inc\nPlanck source at layer edge in increasing ilay direction [W/m2] (nlay, ncol), includes spectral weighting that accounts for state-dependent frequency to g-space mapping\nlev_source_dec\nPlanck source at layer edge in decreasing ilay direction [W/m2] (nlay, ncol), includes spectral weighting that accounts for state-dependent frequency to g-space mapping\nsfc_source\nSurface source [W/m2] (ncol)\nsrc_up\ntemporary storage array used in no scattering GPU calculations (nlay, ncol)\nsrc_dn\ntemporary storage array used in no scattering GPU calculations (nlay, ncol)\n\n\n\n\n\n","category":"type"},{"location":"optics/Sources/#RRTMGP.Sources.SourceLW2Str","page":"Source Functions","title":"RRTMGP.Sources.SourceLW2Str","text":"SourceLW2Str{FT,FTA1D,FTA2D} <: AbstractSourceLW{FT,FTA1D,FTA2D}\n\nLongwave sources: computed at layer center, layer edges,  and at the surface for 2-stream calculations\n\nFields\n\nparam_set\nParameter set\nlay_source\nPlanck source at layer average temperature [W/m2] (nlay, ncol)\nlev_source_inc\nPlanck source at layer edge in increasing ilay direction [W/m2] (nlay, ncol), includes spectral weighting that accounts for state-dependent frequency to g-space mapping\nlev_source_dec\nPlanck source at layer edge in decreasing ilay direction [W/m2] (nlay, ncol), includes spectral weighting that accounts for state-dependent frequency to g-space mapping\nsfc_source\nSurface source [W/m2] (ncol)\nlev_source\nlevel source [W/m2] (nlay+1, ncol), used in 2 stream calculations\nsrc_up\ntemporary storage array, used in 2 stream calculations (nlay, ncol)\nsrc_dn\ntemporary storage array, used in 2 stream calculations (nlay, ncol)\nRdif\ntemporary storage array, used in 2 stream calculations (nlay, ncol)\nTdif\ntemporary storage array, used in 2 stream calculations (nlay, ncol)\nalbedo\ntemporary storage array, used in 2 stream calculations (nlay + 1, ncol)\nsrc\ntemporary storage array, used in 2 stream calculations (nlay + 1, ncol)\n\n\n\n\n\n","category":"type"},{"location":"optics/Sources/#RRTMGP.Sources.SourceSW2Str","page":"Source Functions","title":"RRTMGP.Sources.SourceSW2Str","text":"SourceSW2Str{FT,FTA1D,FTA2D}\n\nShortwave sources: computed at layer center, layer edges,  and at the surface for 2-stream calculations\n\nFields\n\nsfc_source\nsurface source (ncol)\nalbedo\nalbedo (nlay + 1, ncol)\nsrc_up\ntemporary storage array, used in 2 stream calculations (nlay, ncol)\nsrc_dn\ntemporary storage array, used in 2 stream calculations (nlay, ncol)\nRdif\ntemporary storage array, used in 2 stream calculations (nlay, ncol)\nTdif\ntemporary storage array, used in 2 stream calculations (nlay, ncol)\nRdir\ntemporary storage array, used in 2 stream calculations (nlay, ncol)\nTdir\ntemporary storage array, used in 2 stream calculations (nlay, ncol)\nTnoscat\ntemporary storage array, used in 2 stream calculations (nlay, ncol)\nsrc\ntemporary storage array, used in 2 stream calculations (nlay + 1, ncol)\n\n\n\n\n\n","category":"type"},{"location":"optics/Sources/#RRTMGP.Sources.source_func_longwave","page":"Source Functions","title":"RRTMGP.Sources.source_func_longwave","text":"source_func_longwave(\n    param_set,\n    ::Type{FT},\n    ncol::Int,\n    nlay::Int,\n    OPC::Symbol,\n    ::Type{DA},\n) where {FT<:AbstractFloat,DA}\n\nInitializes the longwave source for one scalar and two stream simulations.\n\n\n\n\n\n","category":"function"},{"location":"optics/Sources/#RRTMGP.Sources.source_func_shortwave","page":"Source Functions","title":"RRTMGP.Sources.source_func_shortwave","text":"source_func_shortwave(\n    ::Type{FT},\n    ncol::I,\n    nlay::I,\n    opc::Symbol,\n    ::Type{DA},\n) where {FT<:AbstractFloat,I<:Int,DA}\n\nInitializes the shortwave source for one scalar and two stream simulations.\n\n\n\n\n\n","category":"function"},{"location":"#RRTMGP.jl","page":"Home","title":"RRTMGP.jl","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Julia implementation of Rapid and accurate Radiative Transfer Model for General Circulation Models in Parallel (RRTMGP).","category":"page"},{"location":"#Code-structure","page":"Home","title":"Code structure","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"RRTMGP is fundamentally split into two parts:","category":"page"},{"location":"","page":"Home","title":"Home","text":"Optics** Computes optical depth given atmospheric conditions (pressure, temperature, gas concentrations, grid)\nRTE Computes fluxes given optical depth","category":"page"},{"location":"optics/Fluxes/#Fluxes","page":"Fluxes","title":"Fluxes","text":"","category":"section"},{"location":"optics/Fluxes/","page":"Fluxes","title":"Fluxes","text":"CurrentModule = RRTMGP.Fluxes","category":"page"},{"location":"optics/Fluxes/","page":"Fluxes","title":"Fluxes","text":"FluxLW\nFluxSW\nset_flux_to_zero!\nadd_to_flux!","category":"page"},{"location":"optics/Fluxes/#RRTMGP.Fluxes.FluxLW","page":"Fluxes","title":"RRTMGP.Fluxes.FluxLW","text":"FluxLW{FT,FTA2D}\n\nUpward, downward and net longwave fluxes at each level.\n\nFields\n\nflux_up\nupward flux [W/m²] (nlev,ncol)\nflux_dn\ndownward flux [W/m²] (nlev,ncol)\nflux_net\nnet flux [W/m²] (nlev,ncol)\n\n\n\n\n\n","category":"type"},{"location":"optics/Fluxes/#RRTMGP.Fluxes.FluxSW","page":"Fluxes","title":"RRTMGP.Fluxes.FluxSW","text":"FluxSW{FT,FTA2D}\n\nUpward, downward and net shortwave fluxes at each level.\n\nFields\n\nflux_up\nupward flux [W/m²] (nlev,ncol)\nflux_dn\ndownward flux [W/m²] (nlev,ncol)\nflux_net\nnet flux [W/m²] (nlev,ncol)\nflux_dn_dir\ndirect downward flux [W/m²] (nlev,ncol)\n\n\n\n\n\n","category":"type"},{"location":"optics/Fluxes/#RRTMGP.Fluxes.set_flux_to_zero!","page":"Fluxes","title":"RRTMGP.Fluxes.set_flux_to_zero!","text":"set_flux_to_zero!(flux::FluxLW{FT}) where {FT<:AbstractFloat}\n\nSet longwave flux to zero\n\n\n\n\n\nset_flux_to_zero!(flux::FluxLW{FT}, gcol::Int) where {FT<:AbstractFloat}\n\nSet longwave flux for column gcol to zero\n\n\n\n\n\nset_flux_to_zero!(flux::FluxSW{FT}) where {FT<:AbstractFloat}\n\nSet shortwave flux to zero\n\n\n\n\n\nset_flux_to_zero!(flux::FluxSW{FT}, gcol::Int) where {FT<:AbstractFloat}\n\nSet shortwave flux for column gcol to zero\n\n\n\n\n\n","category":"function"},{"location":"optics/Fluxes/#RRTMGP.Fluxes.add_to_flux!","page":"Fluxes","title":"RRTMGP.Fluxes.add_to_flux!","text":"add_to_flux!(flux1::FluxLW, flux2::FluxLW)\n\nadd longwave flux2 to longwave flux1  flux1 .+= flux2\n\n\n\n\n\nadd_to_flux!(flux1::FluxLW, flux2::FluxLW, gcol::Int)\n\nadd longwave flux2 to longwave flux1 for column gcol flux1 .+= flux2\n\n\n\n\n\nadd_to_flux!(flux1::FluxSW, flux2::FluxSW)\n\nadd shortwave flux2 to shortwave flux1  flux1 .+= flux2\n\n\n\n\n\nadd_to_flux!(flux1::FluxSW, flux2::FluxSW, gcol::Int)\n\nadd shortwave flux2 to shortwave flux1 for column gcol flux1 .+= flux2\n\n\n\n\n\n","category":"function"}]
}
