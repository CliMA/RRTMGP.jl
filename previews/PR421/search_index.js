var documenterSearchIndex = {"docs":
[{"location":"optics/LookUpTables/#Lookup-tables","page":"Lookup Tables","title":"Lookup tables","text":"","category":"section"},{"location":"optics/LookUpTables/","page":"Lookup Tables","title":"Lookup Tables","text":"CurrentModule = RRTMGP.LookUpTables","category":"page"},{"location":"optics/LookUpTables/","page":"Lookup Tables","title":"Lookup Tables","text":"LookUpLW\nLookUpSW\nLookUpCld\nPadeCld\nAbstractLookUp","category":"page"},{"location":"optics/LookUpTables/#RRTMGP.LookUpTables.LookUpLW","page":"Lookup Tables","title":"RRTMGP.LookUpTables.LookUpLW","text":"LookUpLW{FT,UI8A1D,IA1D,IA2D,IA3D,FTA1D,FTA2D,FTA3D,FTA4D} <: \n    AbstractLookUp\n\nLongwave lookup tables, used to compute optical properties. \n\nFields\n\nn_gases: number of gases used in the lookup table\nn_bnd: number of longwave bands\nn_gpt: number of g-points\nn_atmos_layers: number of atmospheric layers (=2, lower and upper atmospheres)\nn_t_ref: number of reference temperatures for absorption coefficient lookup table\nn_p_ref: number of reference pressures for absorption lookup table\nn_η: number of reference binary mixing fractions, for absorption coefficient lookup table\nn_t_plnk: number of reference temperatures, for Planck source calculations\nn_maj_absrb: number of major absorbing gases\nn_min_absrb: number of minor absorbing gases\nn_min_absrb_lower: number of minor absorbers in lower atmosphere\nn_min_absrb_upper: number of minor absorbers in upper atmosphere\nn_absrb_ext\nn_contrib_lower: number of minor contributors in the lower atmosphere\nn_contrib_upper: number of minor contributors in the upper atmosphere\nidx_h2o: vmr array index for h2o\np_ref_tropo: Reference pressure separating upper and lower atmosphere\nt_ref_absrb: Reference temperature\np_ref_absrb: Reference pressure\np_ref_min: minimum pressure supported by RRTMGP lookup tables\nΔ_t_ref: Δt for reference temperature values (Δt is constant)\nΔ_ln_p_ref: Δ for log of reference pressure values (Δp is constant)\nidx_gases_minor_lower: indices for minor gases contributing to absorption in the lower atmosphere (n_min_absrb_lower)\nidx_gases_minor_upper: indices for minor gases contributing to absorption in the upper atmosphere (n_min_absrb_upper)\nidx_scaling_gas_lower: indices for scaling gases in the lower atmosphere (n_min_absrb_lower)\nidx_scaling_gas_upper: indices for scaling gases in the upper atmosphere (n_min_absrb_upper)\nkey_species: major absorbing species in each band (2, n_atmos_layers, n_bnd)\nkmajor: major absorption coefficient (n_gpt, n_η, n_p_ref, n_t_ref)\nkminor_lower: minor absorption coefficient in lower atmosphere (n_contrib_lower, n_η, n_t_ref)\nkminor_upper: minor absorption coefficient in upper atmosphere (n_contrib_upper, n_η, n_t_ref)\nkminor_start_lower\nkminor_start_upper\nplanck_fraction: Planck fraction (n_gpt, n_η, n_p_ref, n_t_ref)\nt_planck: reference temperatures for Planck source calculations (n_t_plnk)\ntotplnk: total Planck source for each band (n_t_plnk, n_bnd)\nmajor_gpt2bnd: map from g-point to band\nbnd_lims_gpt: starting and ending g-point for each band (2, n_bnd)\nbnd_lims_wn: starting and ending wavenumber for each band (2, n_bnd)\nminor_lower_gpt_lims: g-point limits for minor contributors in lower atmosphere (2, n_contrib_lower)\nminor_upper_gpt_lims: g-point limits for minor contributors in upper atmosphere (2, n_contrib_upper)\nminor_lower_bnd: band number for minor contributor in the lower atmosphere (n_contrib_lower)\nminor_upper_bnd: band number for minor contributor in the upper atmosphere (n_contrib_upper)\nminor_lower_bnd_st: starting index to idx_gases_minor_lower for each band (n_bnd)\nminor_upper_bnd_st: starting index to idx_gases_minor_upper for each band (n_bnd)\nminor_lower_gpt_sh: shift in kminor_lower for each band (n_min_absrb_lower)\nminor_upper_gpt_sh: shift in kminor_upper for each band (n_min_absrb_upper)\nminor_lower_scales_with_density: minor gas (lower atmosphere) scales with density? (n_min_absrb_lower)\nminor_upper_scales_with_density: minor gas (upper atmosphere) scales with density? (n_min_absrb_upper)\nlower_scale_by_complement: minor gas (lower atmosphere) scales by compliment (n_min_absrb_lower)\nupper_scale_by_complement: minor gas (upper atmosphere) scales by compliment (n_min_absrb_upper)\nln_p_ref: log of reference pressures used by the lookup table (n_p_ref)\nt_ref: reference temperatures used by the lookup table (n_t_ref)\nvmr_ref: reference volume mixing ratios used by the lookup table (2, n_gases, n_t_ref)\n\n\n\n\n\n","category":"type"},{"location":"optics/LookUpTables/#RRTMGP.LookUpTables.LookUpSW","page":"Lookup Tables","title":"RRTMGP.LookUpTables.LookUpSW","text":"LookUpSW{FT,UI8A1D,IA1D,IA2D,IA3D,FTA1D,FTA2D,FTA3D,FTA4D} <:\n    AbstractLookUp\n\nShortwave lookup tables, used to compute optical properties. \n\nFields\n\nn_gases: number of gases used in the lookup table\nn_bnd: number of shortwave bands\nn_gpt: number of g-points\nn_atmos_layers: number of atmospheric layers (=2, lower and upper atmospheres)\nn_t_ref: number of reference temperatures for absorption coefficient lookup table\nn_p_ref: number of reference pressures for absorption lookup table\nn_η: number of reference binary mixing fractions, for absorption coefficient lookup table\nn_maj_absrb: number of major absorbing gases\nn_min_absrb: number of minor absorbing gases\nn_min_absrb_lower: number of minor absorbers in lower atmosphere\nn_min_absrb_upper: number of minor absorbers in upper atmosphere\nn_absrb_ext\nn_contrib_lower: number of minor contributors in the lower atmosphere\nn_contrib_upper: number of minor contributors in the upper atmosphere\nidx_h2o: vmr array index for h2o\np_ref_tropo: Reference pressure separating upper and lower atmosphere\nt_ref_absrb: Reference temperature\np_ref_absrb: Reference pressure\np_ref_min: minimum pressure supported by RRTMGP lookup tables\nΔ_t_ref: Δt for reference temperature values (Δt is constant, array is linearly equispaced)\nΔ_ln_p_ref: Δ for log of reference pressure values (Δ is constant, equispaced on logarithmic scale)\nsolar_src_tot: total solar irradiation\nidx_gases_minor_lower: indices for minor gases contributing to absorption in the lower atmosphere (n_min_absrb_lower)\nidx_gases_minor_upper: indices for minor gases contributing to absorption in the upper atmosphere (n_min_absrb_upper)\nidx_scaling_gas_lower: indices for scaling gases in the lower atmosphere (n_min_absrb_lower)\nidx_scaling_gas_upper: indices for scaling gases in the upper atmosphere (n_min_absrb_upper)\nkey_species: major absorbing species in each band (2, n_atmos_layers, n_bnd)\nkmajor: major absorption coefficient (n_gpt, n_η, n_p_ref, n_t_ref)\nkminor_lower: minor absorption coefficient in lower atmosphere (n_contrib_lower, n_η, n_t_ref)\nkminor_upper: minor absorption coefficient in upper atmosphere (n_contrib_upper, n_η, n_t_ref)\nkminor_start_lower\nkminor_start_upper\nmajor_gpt2bnd: map from g-point to band\nbnd_lims_gpt: starting and ending g-point for each band (2, n_bnd)\nbnd_lims_wn: starting and ending wavenumber for each band (2, n_bnd)\nminor_lower_gpt_lims: g-point limits for minor contributors in lower atmosphere (2, n_contrib_lower)\nminor_upper_gpt_lims: g-point limits for minor contributors in upper atmosphere (2, n_contrib_upper)\nminor_lower_bnd: band number for minor contributor in the lower atmosphere (n_contrib_lower)\nminor_upper_bnd: band number for minor contributor in the upper atmosphere (n_contrib_upper)\nminor_lower_bnd_st: starting index to idx_gases_minor_lower for each band\nminor_upper_bnd_st: starting index to idx_gases_minor_upper for each band\nminor_lower_gpt_sh: shift in kminor_lower for each band (n_min_absrb_lower)\nminor_upper_gpt_sh: shift in kminor_upper for each band (n_min_absrb_upper)\nminor_lower_scales_with_density: minor gas (lower atmosphere) scales with density? (n_min_absrb_lower)\nminor_upper_scales_with_density: minor gas (upper atmosphere) scales with density? (n_min_absrb_upper)\nlower_scale_by_complement: minor gas (lower atmosphere) scales by compliment (n_min_absrb_lower)\nupper_scale_by_complement: minor gas (upper atmosphere) scales by compliment (n_min_absrb_upper)\nln_p_ref: log of reference pressures used by the lookup table (n_p_ref)\nt_ref: reference temperatures used by the lookup table (n_t_ref)\nvmr_ref: reference volume mixing ratios used by the lookup table (2, n_gases, n_t_ref)\nrayl_lower: Rayleigh absorption coefficient for lower atmosphere (n_gpt, n_η, n_t_ref)\nrayl_upper: Rayleigh absorption coefficient for upper atmosphere (n_gpt, n_η, n_t_ref)\nsolar_src_scaled: relative solar source contribution from each g-point (n_gpt)\n\n\n\n\n\n","category":"type"},{"location":"optics/LookUpTables/#RRTMGP.LookUpTables.LookUpCld","page":"Lookup Tables","title":"RRTMGP.LookUpTables.LookUpCld","text":"LookUpCld{FT,FTA2D,FTA3D}\n\nLookup table for cloud optics.\n\nThis struct stores the lookup tables for determing extinction coeffient,  single-scattering albedo, and asymmetry parameter g as a function of effective radius. We compute the optical depth tau (=exintinction coeff * condensed water path) and the products taussa and taussa*g for liquid and ice cloud separately. These are used to determine the optical properties of ice and water cloud together.\n\nFields\n\nradliq_lwr: liquid particle size lower bound for LUT interpolation\nradliq_upr: liquid particle size upper bound for LUT interpolation\nradliq_fac: factor for calculating LUT interpolation for liquid particle\nradice_lwr: ice particle size lower bound for LUT interpolation\nradice_upr: ice particle size upper bound for LUT interpolation\nradice_fac: factor for calculating LUT interpolation for ice particle\nlut_extliq: LUT liquid extinction coefficient (nsize_liq, nbnd) m²/g\nlut_ssaliq: LUT liquid single scattering albedo (nsize_liq, nbnd)\nlut_asyliq: LUT liquid asymmetry parameter (nsize_liq, nbnd)\nlut_extice: LUT ice extinction coefficient (nsize_ice, nband, nrghice) m²/g\nlut_ssaice: LUT ice single scattering albedo (nsize_ice, nband, nrghice)\nlut_asyice: LUT ice asymmetry parameter (nsize_ice, nband, nrghice)\nbnd_lims_wn: beginning and ending wavenumber for each band (2, nband) cm⁻¹\n\n\n\n\n\n","category":"type"},{"location":"optics/LookUpTables/#RRTMGP.LookUpTables.PadeCld","page":"Lookup Tables","title":"RRTMGP.LookUpTables.PadeCld","text":"PadeCld{FTA1D,FTA2D,FTA3D,FTA4D}\n\nPade coefficients for cloud optics.\n\nThis struct stores the Pade coefficients for determing extinction coeffient,  single-scattering albedo, and asymmetry parameter g as a function of effective radius. We compute the optical depth tau (=exintinction coeff * condensed water path) and the products taussa and taussa*g for liquid and ice cloud separately. These are used to determine the optical properties of ice and water cloud together.\n\nFields\n\npade_extliq: pade coefficients for liquid extinction (nband, nsizereg, ncoeff_ext)\npade_ssaliq: pade coefficients for liquid single scattening albedo (nband, nsizereg, ncoeff_ssa_g)\npade_asyliq: pade coefficients for liquid asymmetry paramter (nband, nsizereg, ncoeff_ssa_g)\npade_extice: pade coefficients for ice extinction (nband, nsizereg, ncoeff_ext, nrghice)\npade_ssaice: pade coefficients for ice single scattening albedo (nband, nsizereg, ncoeff_ssa_g, nrghice)\npade_asyice: pade coefficients for ice asymmetry paramter (nband, nsizereg, ncoeff_ssa_g, nrghice)\npade_sizreg_extliq: pade size regime boundaries for liquid extinction coefficient for pade interpolation (nbound) μm\npade_sizreg_ssaliq: pade size regime boundaries for liquid single scattering albedo for pade interpolation (nbound) μm\npade_sizreg_asyliq: pade size regime boundaries for liquid asymmetry parameter for pade interpolation (nbound) μm\npade_sizreg_extice: pade size regime boundaries for ice extinction coefficient for pade interpolation (nbound) μm\npade_sizreg_ssaice: pade size regime boundaries for ice single scattering albedo for pade interpolation (nbound) μm\npade_sizreg_asyice: pade size regime boundaries for ice asymmetry parameter for pade interpolation (nbound) μm\nbnd_lims_wn: beginning and ending wavenumber for each band (2, nband) cm⁻¹\n\n\n\n\n\n","category":"type"},{"location":"optics/LookUpTables/#RRTMGP.LookUpTables.AbstractLookUp","page":"Lookup Tables","title":"RRTMGP.LookUpTables.AbstractLookUp","text":"AbstractLookUp\n\nAbstract lookup table for longwave and shortwave problems.\n\n\n\n\n\n","category":"type"},{"location":"optics/GrayUtils/#Utilities-for-gray-radiation-simulation","page":"Utilities for gray radiation simulation","title":"Utilities for gray radiation simulation","text":"","category":"section"},{"location":"optics/GrayUtils/","page":"Utilities for gray radiation simulation","title":"Utilities for gray radiation simulation","text":"CurrentModule = RRTMGP.GrayUtils","category":"page"},{"location":"optics/GrayUtils/","page":"Utilities for gray radiation simulation","title":"Utilities for gray radiation simulation","text":"update_profile_lw!\ncompute_gray_heating_rate!","category":"page"},{"location":"optics/GrayUtils/#RRTMGP.GrayUtils.update_profile_lw!","page":"Utilities for gray radiation simulation","title":"RRTMGP.GrayUtils.update_profile_lw!","text":"update_profile_lw!(\n    param_set,\n    t_lay,\n    t_lev,\n    flux_dn,\n    flux_net,\n    hr_lay,\n    flux_grad,\n    T_ex_lev,\n    Δt,\n    nlay,\n    nlev,\n    ncol,\n    ::Type{FT},\n)\n\nUpdates tlay and tlev based on heating rate.\n\n\n\n\n\n","category":"function"},{"location":"optics/GrayUtils/#RRTMGP.GrayUtils.compute_gray_heating_rate!","page":"Utilities for gray radiation simulation","title":"RRTMGP.GrayUtils.compute_gray_heating_rate!","text":"compute_gray_heating_rate!(\n    context,\n    hr_lay,\n    p_lev,\n    ncol,\n    nlay,\n    flux_net,\n    param_set,\n    ::Type{FT},\n)\n\nComputes the heating rate for the gray radiation simulation.\n\n\n\n\n\n","category":"function"},{"location":"Optics/#RRTMGP-Optics","page":"Optics","title":"RRTMGP Optics","text":"","category":"section"},{"location":"Optics/","page":"Optics","title":"Optics","text":"compute_optical_props! computes the optical properties and source functions given an atmospheric state. For the two-stream approximation, the optical properties include the optical thickness of the atmosphere layer (tau), single-scattering albedo (omega_0), and asymmetry parameter (g).","category":"page"},{"location":"Optics/#Gray-atmosphere-optics","page":"Optics","title":"Gray atmosphere optics","text":"","category":"section"},{"location":"Optics/","page":"Optics","title":"Optics","text":"The gray atmosphere (more precisely, semi-gray atmosphere) approximates the radiative properties of the atmosphere by taking the optical properties to be independent of wavelength, separately in the longwave and shortwave bands. ","category":"page"},{"location":"Optics/#Longwave","page":"Optics","title":"Longwave","text":"","category":"section"},{"location":"Optics/","page":"Optics","title":"Optics","text":"Two options are currently supported for computing the optical depth for longwave radiation. The optical depth (d) for longwave radiation, with the \"GrayOpticalThicknessSchneider2004\" option, follows [4]:","category":"page"},{"location":"Optics/","page":"Optics","title":"Optics","text":"beginalign\nd(phi p) = d_0(phi) left(fracpp_0right)^alpha\nendalign","category":"page"},{"location":"Optics/","page":"Optics","title":"Optics","text":"Here, alpha  is ratio of the pressure scale height to the partial-pressure scale height of the infrared absorber (alpha=35 for water vapor); phi is the latitude; p is the pressure, and p_0 = 1000mathrmhPa is the reference pressure. The optical depth at phi and p_0, d_0, is calculated from the latitude-dependent radiative equilibrium temperature T_s(phi):","category":"page"},{"location":"Optics/","page":"Optics","title":"Optics","text":"beginalign\nT_s(phi) = T_e + Delta T left(frac13 - sin^2phiright) \nd_0(phi) = left(fracT_s(phi)T_tright)^4 - 1\nendalign","category":"page"},{"location":"Optics/","page":"Optics","title":"Optics","text":"Here, T_e is the global-mean surface temperature in radiative equilibrium, T_t is the temperature at the top of the atmosphere, and Delta T is the equator-to-pole temperature difference in radiative equilibrium. The default values are T_e = 300mathrmK, T_t = 200mathrmK, and Delta T = 60mathrmK.","category":"page"},{"location":"Optics/","page":"Optics","title":"Optics","text":"The optical thickness of an atmosphere layer (the differential optical depth) of pressure thickness Delta p is","category":"page"},{"location":"Optics/","page":"Optics","title":"Optics","text":"beginalign\ntau(phi p) = alpha d_0(phi) left(fracpp_0right)^alpha fracDelta pp\nendalign","category":"page"},{"location":"Optics/","page":"Optics","title":"Optics","text":"The optical depth (d) for longwave radiation, with the \"GrayOpticalThicknessOGorman2008\" option, follows [5]:","category":"page"},{"location":"Optics/","page":"Optics","title":"Optics","text":"beginalign\nd(phi p) = alpha leftf_l sigma + (1 - f_l) sigma^4 right left tau_e + (tau_p - tau_e) sin^2phi right\nendalign","category":"page"},{"location":"Optics/","page":"Optics","title":"Optics","text":"where f_l = 02, sigma = p  p_0 is pressure p normalized by surface pressure p_0, phi is latitude, and the longwave optical thicknesses at the equator and at the pole are  tau_e = 72 and tau_p = 18, respectively. alpha is a scaling factor. ","category":"page"},{"location":"Optics/","page":"Optics","title":"Optics","text":"The optical thickness of an atmosphere layer (the differential optical depth) of pressure thickness Delta p is","category":"page"},{"location":"Optics/","page":"Optics","title":"Optics","text":"beginalign\ntau(phi p) = (alpha * fracDelta pp) leftf_l sigma + 4 (1 - f_l) sigma^4 right left tau_e + (tau_p - tau_e) sin^2phi right\nendalign","category":"page"},{"location":"Optics/","page":"Optics","title":"Optics","text":"The source function for longwave radiation is calculated as S = sigma T^4  pi, where T is the air temperature and sigma is the Stefan–Boltzmann constant.","category":"page"},{"location":"Optics/#Shortwave","page":"Optics","title":"Shortwave","text":"","category":"section"},{"location":"Optics/","page":"Optics","title":"Optics","text":"Two options are currently supported for computing the optical depth for shortwave radiation. The optical depth (d) for shortwave radiation, with the \"GrayOpticalThicknessSchneider2004\" option, is 0.","category":"page"},{"location":"Optics/","page":"Optics","title":"Optics","text":"The optical depth (d) for shortwave radiation, with the \"GrayOpticalThicknessOGorman2008\" option, follows [6] and [5]:","category":"page"},{"location":"Optics/","page":"Optics","title":"Optics","text":"beginalign\nd(p) = tau_0 left(fracpp_0right)^2\nendalign","category":"page"},{"location":"Optics/","page":"Optics","title":"Optics","text":"where p is the pressure of the atmosphere layer and p_0 = 1000mathrmhPa is the reference pressure. The default value for tau_0 is 0.22. ","category":"page"},{"location":"Optics/","page":"Optics","title":"Optics","text":"The differential optical thickness of an atmosphere layer of pressure thickness Delta p is","category":"page"},{"location":"Optics/","page":"Optics","title":"Optics","text":"beginalign\ntau(p) = 2 tau_0 fracpp_0 fracDelta pp_0\nendalign","category":"page"},{"location":"Optics/","page":"Optics","title":"Optics","text":"The single scattering albedo and asymmetry parameter are zero.","category":"page"},{"location":"Optics/#Gas-optics","page":"Optics","title":"Gas optics","text":"","category":"section"},{"location":"Optics/","page":"Optics","title":"Optics","text":"RRTMGP calculates gas optics using a correlated-k method, in which the integration over frequency nu of a complex line spectrum is replaced by an integration over a much smoother function of a new variable g. The integral is approximated by the sum over G quadrature points (g-points). The mapping from nu to g is computed for a set of longwave and shortwave bands. Within each band, the absorption is dominated by no more two gases (major species). The bands are non-overlapping, contiguous, and span the frequencies of radiation emitted by the Earth or Sun. For each band, the total optical thickness (tau) includes contributions from major species (tau_mathrmmajor), minor species (tau_mathrmminor), and Rayleigh scattering (tau_mathrmrayleigh) for shortwave bands.","category":"page"},{"location":"Optics/","page":"Optics","title":"Optics","text":"compute_τ_ssa_lw_src! calculates the optical properties for each g-point in the longwave and shortwave bands, as well as source functions for the longwave bands. The input atmospheric conditions include pressure (p), temperature (T), and volume mixing ratios of gases (chi). The relationship between the volume mixing ratio and the mass fraction (q) of a gas is chi = q  q_d * M_d  M, where q_d = 1-q_t is the dry air mass fraction (total specific humidity q_t), M_d is the molar mass of the dry air, and M is the molar mass of the gas. ","category":"page"},{"location":"Optics/","page":"Optics","title":"Optics","text":"For the major species, the absorption coefficient is computed by linearly interpolating the tabulated values in log(p), T, and relative abundances of the two major species (eta) calculated from the volume mixing ratios. The contributions from minor species and Rayleigh scattering are treated with less detail. For each minor species and Rayleigh scattering, a representative pressure is chosen, and the absorption coefficient is computed by linearly interpolating the tabulated values in T and eta. For the shortwave bands, the single scattering albedo is calculated as omega_0 = tau_mathrmrayleigh  tau, and the asymmetry parameter is zero.","category":"page"},{"location":"Optics/","page":"Optics","title":"Optics","text":"For longwave bands, the Planck fraction (defined as the fraction of the band-integrated Planck energy associated with each g-point) is computed by linearly interpolating the tabulated values in log(p), T, and eta. The band-integrated Planck function is uniquely determined by temperature, and is computed by linearly interpolating the tabulated values in T. The shortwave source function for each g-point is assumed to be constant.","category":"page"},{"location":"Optics/#Lookup-tables","page":"Optics","title":"Lookup tables","text":"","category":"section"},{"location":"Optics/","page":"Optics","title":"Optics","text":"The lookup tables for the spectral map between nu and g are stored in netcdf files here. Longwave and shortwave lookup tables are stored in clearsky_lw.nc and clearsky_sw.nc, respectively. LookUpLW and LookUpSW read the lookup tables. The tabulated information includes the spectral discretization (bands), the major and minor gases considered in each band, and tabulated data of absorption coefficients, Planck fraction, and band-integrated Planck function. The absorption coefficients and Planck fraction are computed at pressures 1 mathrmPa  p  109663 mathrmPa in increments of log(p1 mathrmPa) = 02, temperatures 160 mathrmK  T  355 mathrmK in 15 mathrmK increments, and 0  eta  1 in 18 increments. The band-integrated Plack function is computed at temperatures 160 mathrmK  T  355 mathrmK in 1 mathrmK increments. A more detailed description of the spectral structure of the lookup tables can be found in Appendix A in [7].","category":"page"},{"location":"Optics/","page":"Optics","title":"Optics","text":"note: Note\nAbsorption by both major and minor species is treated separately in the upper and lower atmosphere, defined as pressures above and below the pressure defined in press_ref_trop in the lookup tables (~9948 Pa). This corresponds to element 13 in array press_ref. There is a single large table of absorption coefficients. Table elements 1:13 in the pressure dimension correspond to pressures >= press_ref_trop, while table elements 14:60 correspond to pressures <= press_ref_trop. Elements 13 and 14 refer to the same pressure but for the lower and upper atmosphere, respectively. This is why the the absorption coefficients lookup table has a pressure dimension of 60, but there are only 59 reference pressure levels in press_ref.","category":"page"},{"location":"Optics/#Cloud-optics","page":"Optics","title":"Cloud optics","text":"","category":"section"},{"location":"Optics/","page":"Optics","title":"Optics","text":"note: Note\nCloud optics can be calculated using either lookup tables or Pade approximations. Only the lookup table method is documented here.","category":"page"},{"location":"Optics/","page":"Optics","title":"Optics","text":"compute_cld_props computes the optical properties of clouds, which is a combination of contributions from liquid and ice particles. The optical thickness (tau), single scattering albedo (omega_0), and asymmetry parameter (g) for clouds are:","category":"page"},{"location":"Optics/","page":"Optics","title":"Optics","text":"beginalign\ntau_c = tau_l + tau_i \nomega_0c = fractau_l omega_0l + tau_i omega_0itau_l + tau_i \ng_c = fractau_l omega_0l g_l + tau_i omega_0i g_itau_l omega_0l + tau_i omega_0i \nendalign","category":"page"},{"location":"Optics/","page":"Optics","title":"Optics","text":"where subscripts c, l, and i indicate cloud, liquid, and ice, respectively. The liquid cloud and ice cloud optical thicknesses are calculated by multiplying the cloud liquid and ice extinction coefficients (mu) by the cloud liquid (lwp) and ice water paths (iwp), respectively. That is, tau_l = mu_l mathrmlwp and tau_i = mu_i mathrmiwp. The extinction coefficient, single scattering albedo, and asymmetry parameter are computed by linearly interpolating the tabulated values in the liquid and ice particle effective radius. For ice partices, the optical properties also depend on the surface roughness, following [8]. The optical properties for shortwave bands are delta-scaled to reduce the biases in calculating radiative fluxes for highly asymmetric phase functions ([9]).","category":"page"},{"location":"Optics/","page":"Optics","title":"Optics","text":"add_cloud_optics_2stream adds cloud optics to the gas optics for each g-point that sees cloud (the cloud mask is described below).","category":"page"},{"location":"Optics/#Lookup-tables-2","page":"Optics","title":"Lookup tables","text":"","category":"section"},{"location":"Optics/","page":"Optics","title":"Optics","text":"The lookup tables for cloud optics are stored in netcdf files here. Longwave and shortwave lookup tables are stored in cloudysky_lw.nc and cloudysky_sw.nc, respectively. LookUpCld reads the lookup tables. The tabulated information includes tabulated data of extinction coefficients, single scattering albedo, and asymmetry parameter for liquid and ice particles. The optical properties for liquid particles are computed at radius 25 mathrmmu m  r_l  215 mathrmmu m in increments of 1 mathrmmu m. The optical properties for ice particles are computed at radius 10 mathrmmu m  r_i  180 mathrmmu m in increments of 10 mathrmmu m.","category":"page"},{"location":"Optics/#Cloud-overlap-method","page":"Optics","title":"Cloud overlap method","text":"","category":"section"},{"location":"Optics/","page":"Optics","title":"Optics","text":"Climate models predict grid-mean cloud fraction and cloud condensates, and the vertical structure of clouds needs to be prescribed using some overlap assumptions for calculating radiative fluxes. The Monte Carlo independent column approximation (McICA) allows us to have fractional cloud areas, by randomly assigning some wavelengths to see cloud and other wavelengths to see no cloud. build_cloud_mask! builds McICA-sampled cloud masks from cloud fraction. We use the maximum-random overlap method, which maximizes the cloud overlap between adjacent layers but randomly distributes clouds at different altitudes separated by clear sky. The random numbers are generated for each layer and each g-point. For a certain layer (layer 1), the g-points that have been assigned a random number larger than one minus the cloud fraction see cloud, and the other g-points see clear-sky. The random numbers are recalculated for the layer below (layer 2). If the g-point sees cloud in layer 1, its random number in layer 2 is changed to the one in layer 1. If the g-point sees clear-sky in layer 1, its random number in layer 2 is multiplied by one minus the cloud fraction of layer 1. This ensures that the random numbers in layer 2 are randomly distributed in the range [0, 1].","category":"page"},{"location":"rte/RTESolver/#RTE-Solver","page":"RTE Solver","title":"RTE Solver","text":"","category":"section"},{"location":"rte/RTESolver/","page":"RTE Solver","title":"RTE Solver","text":"CurrentModule = RRTMGP.RTESolver","category":"page"},{"location":"rte/RTESolver/","page":"RTE Solver","title":"RTE Solver","text":"solve_lw!\nrte_lw_solve!\nsolve_sw!","category":"page"},{"location":"rte/RTESolver/#RRTMGP.RTESolver.solve_lw!","page":"RTE Solver","title":"RRTMGP.RTESolver.solve_lw!","text":"solve_lw!(\n    slv::Solver,\n    max_threads::Int,\n    lookup_lw::Union{LookUpLW, Nothing} = nothing,\n    lookup_lw_cld::Union{LookUpCld, PadeCld, Nothing} = nothing,\n)\n\nSolver for the longwave radiation problem\n\n\n\n\n\n","category":"function"},{"location":"rte/RTESolver/#RRTMGP.RTESolver.rte_lw_solve!","page":"RTE Solver","title":"RRTMGP.RTESolver.rte_lw_solve!","text":"rte_lw_solve!(\n    context,\n    flux::FluxLW{FT},\n    flux_lw::FluxLW{FT},\n    src_lw::SourceLWNoScat{FT},\n    bcs_lw::LwBCs{FT},\n    op::OneScalar{FT},\n    major_gpt2bnd::AbstractArray{UInt8,1},\n    max_threads,\n    as::AbstractAtmosphericState{FT},\n    lookup_lw::Union{LookUpLW, Nothing} = nothing,\n    lookup_lw_cld::Union{LookUpCld, PadeCld, Nothing} = nothing,\n) where {FT<:AbstractFloat}\n\nNo scattering solver for the longwave problem. LW fluxes, no scattering, mu (cosine of integration angle) specified by column Does radiation calculation at user-supplied angles; converts radiances to flux using user-supplied weights. Currently, only ngaussangles = 1 supported.\n\n\n\n\n\nrte_lw_solve!(\n    context,\n    flux::FluxLW{FT},\n    flux_lw::FluxLW{FT},\n    src_lw::SourceLW2Str{FT},\n    bcs_lw::LwBCs{FT},\n    op::TwoStream{FT},\n    major_gpt2bnd::AbstractArray{UInt8,1},\n    max_threads,\n    as::AbstractAtmosphericState{FT},\n    lookup_lw::Union{LookUpLW, Nothing} = nothing,\n    lookup_lw_cld::Union{LookUpCld, Nothing} = nothing,\n) where {FT<:AbstractFloat}\n\nTwo stream solver for the longwave problem.\n\nRRTMGP provides source functions at each level using the spectral mapping of each adjacent layer. Combine these for two-stream calculations lw combine sources (rtelw2streamcombinesources!) combine RRTMGP-specific sources at levels compute layer reflectance, transmittance compute total source function at levels using linear-in-tau (rtelw2streamsource!) transport (addinglw!)\n\n\n\n\n\n","category":"function"},{"location":"rte/RTESolver/#RRTMGP.RTESolver.solve_sw!","page":"RTE Solver","title":"RRTMGP.RTESolver.solve_sw!","text":"solve_sw!(\n    slv::Solver,\n    max_threads::Int,\n    lookup_sw::Union{LookUpSW, Nothing} = nothing,\n    lookup_sw_cld::Union{LookUpCld, PadeCld, Nothing} = nothing,\n)\n\nSolver for the shortwave radiation problem\n\n\n\n\n\n","category":"function"},{"location":"rte/RTESolver/","page":"RTE Solver","title":"RTE Solver","text":"rte_lw_noscat_source!\nrte_lw_noscat_transport!\nrte_lw_2stream_combine_sources!\nrte_lw_2stream_source!\nadding_lw!\nsw_2stream_coeffs\nrte_sw_noscat!\nrte_sw_2stream!","category":"page"},{"location":"rte/RTESolver/#RRTMGP.RTESolver.rte_lw_noscat_source!","page":"RTE Solver","title":"RRTMGP.RTESolver.rte_lw_noscat_source!","text":"rte_lw_noscat_source!(\n    src_lw::SourceLWNoScat{FT},\n    op::OneScalar{FT},\n    gcol,\n    nlay,\n) where {FT<:AbstractFloat}\n\nCompute LW source function for upward and downward emission at levels using linear-in-tau assumption See Clough et al., 1992, doi: 10.1029/92JD01419, Eq 13\n\n\n\n\n\n","category":"function"},{"location":"rte/RTESolver/#RRTMGP.RTESolver.rte_lw_noscat_transport!","page":"RTE Solver","title":"RRTMGP.RTESolver.rte_lw_noscat_transport!","text":"rte_lw_noscat_transport!(\n    src_lw::SourceLWNoScat{FT},\n    bcs_lw::LwBCs{FT},\n    op::OneScalar{FT},\n    gcol,\n    flux::FluxLW{FT},\n    igpt,\n    ibnd,\n    nlay,\n    nlev,\n) where {FT<:AbstractFloat}\n\nTransport for no-scattering longwave problem.\n\n\n\n\n\n","category":"function"},{"location":"rte/RTESolver/#RRTMGP.RTESolver.rte_lw_2stream_combine_sources!","page":"RTE Solver","title":"RRTMGP.RTESolver.rte_lw_2stream_combine_sources!","text":"rte_lw_2stream_combine_sources!(src::SourceLW2Str, gcol, nlev, ncol)\n\nRRTMGP provides source functions at each level using the spectral mapping of each adjacent layer. This function combines these for two-stream calculations.\n\n\n\n\n\n","category":"function"},{"location":"rte/RTESolver/#RRTMGP.RTESolver.rte_lw_2stream_source!","page":"RTE Solver","title":"RRTMGP.RTESolver.rte_lw_2stream_source!","text":"rte_lw_2stream_source!(\n    op::TwoStream{FT},\n    src_lw::SourceLW2Str{FT},\n    gcol,\n    nlay,\n    ncol,\n) where {FT<:AbstractFloat}\n\nThis function combines RRTMGP-specific sources at levels, computes layer reflectance, transmittance, and total source function at levels using linear-in-tau approximation.\n\n\n\n\n\n","category":"function"},{"location":"rte/RTESolver/#RRTMGP.RTESolver.adding_lw!","page":"RTE Solver","title":"RRTMGP.RTESolver.adding_lw!","text":"adding_lw!(\n    flux::FluxLW{FT},\n    src_lw::SL,\n    bcs_lw::BCL,\n    gcol,\n    igpt,\n    ibnd,\n    nlev,\n    ncol,\n) where {FT<:AbstractFloat,SL<:SourceLW2Str{FT},BCL<:LwBCs{FT}}\n\nTransport of diffuse radiation through a vertically layered atmosphere, for the longwave problem. Equations are after Shonk and Hogan 2008, doi:10.1175/2007JCLI1940.1 (SH08)\n\n\n\n\n\n","category":"function"},{"location":"rte/RTESolver/#RRTMGP.RTESolver.sw_2stream_coeffs","page":"RTE Solver","title":"RRTMGP.RTESolver.sw_2stream_coeffs","text":"sw_2stream_coeffs(τ::FT, ssa::FT, g::FT, μ₀::FT) where {FT}\n\nComputes cell properties (transmittance and reflectance) for direct and diffuse radiation Two-stream solutions to direct and diffuse reflectance and transmittance for a layer with optical depth tau, single scattering albedo w0, and asymmetery parameter g.\n\nEquations are developed in Meador and Weaver, 1980, doi:10.1175/1520-0469(1980)037<0630:TSATRT>2.0.CO;2\n\n\n\n\n\n","category":"function"},{"location":"rte/RTESolver/#RRTMGP.RTESolver.rte_sw_noscat!","page":"RTE Solver","title":"RRTMGP.RTESolver.rte_sw_noscat!","text":"rte_sw_noscat!(\n    flux::FluxSW{FT},\n    op::OneScalar{FT},\n    bcs_sw::SwBCs{FT},\n    solar_frac::FT,\n    gcol,\n    nlev,\n) where {FT<:AbstractFloat}\n\nNo-scattering solver for the shortwave problem. (Extinction-only i.e. solar direct beam)\n\n\n\n\n\n","category":"function"},{"location":"rte/RTESolver/#RRTMGP.RTESolver.rte_sw_2stream!","page":"RTE Solver","title":"RRTMGP.RTESolver.rte_sw_2stream!","text":"rte_sw_2stream!(\n    (; τ, ssa, g)::TwoStream,\n    (; albedo, src)::SourceSW2Str,\n    bcs_sw::SwBCs,\n    (; flux_up, flux_dn, flux_dn_dir)::FluxSW,\n    solar_frac::FT,\n    igpt::Int,\n    n_gpt::Int,\n    ibnd::UInt8,\n    nlev::Int,\n    gcol::Int,\n) where {FT}\n\nTwo stream solver for the shortwave problem.\n\nTransport of diffuse radiation through a vertically layered atmosphere. Equations are after Shonk and Hogan 2008, doi:10.1175/2007JCLI1940.1 (SH08)\n\n\n\n\n\n","category":"function"},{"location":"optics/RTE/#Solver","page":"Solver struct","title":"Solver","text":"","category":"section"},{"location":"optics/RTE/","page":"Solver struct","title":"Solver struct","text":"CurrentModule = RRTMGP.RTE","category":"page"},{"location":"optics/RTE/","page":"Solver struct","title":"Solver struct","text":"Solver","category":"page"},{"location":"optics/RTE/#RRTMGP.RTE.Solver","page":"Solver struct","title":"RRTMGP.RTE.Solver","text":"Solver(\n    context,\n    as,\n    op,\n    src_lw,\n    src_sw,\n    bcs_lw,\n    bcs_sw,\n    fluxb_lw,\n    fluxb_sw,\n    flux_lw,\n    flux_sw\n)\n\nThe high-level RRTMGP data structure storing the atmospheric state, optical properties, sources, boundary conditions and fluxes configurations for a given simulation.\n\nFields\n\ncontext: ClimaComms context\nas: atmospheric state\nop: optical properties\nsrc_lw: source functions\nsrc_sw: source functions\nbcs_lw: boundary conditions\nbcs_sw: boundary conditions\nfluxb_lw: temporary storage for bandwise calculations\nfluxb_sw: temporary storage for bandwise calculations\nflux_lw: fluxes for longwave problem\nflux_sw: fluxes for shortwave problem\n\n\n\n\n\n","category":"type"},{"location":"optics/BCs/#Boundary-Conditions","page":"Boundary Conditions","title":"Boundary Conditions","text":"","category":"section"},{"location":"optics/BCs/","page":"Boundary Conditions","title":"Boundary Conditions","text":"CurrentModule = RRTMGP.BCs","category":"page"},{"location":"optics/BCs/","page":"Boundary Conditions","title":"Boundary Conditions","text":"LwBCs\nSwBCs","category":"page"},{"location":"optics/BCs/#RRTMGP.BCs.LwBCs","page":"Boundary Conditions","title":"RRTMGP.BCs.LwBCs","text":"LwBCs{FT,FTA1D,FTA2DN}\n\nLongwave boundary conditions\n\nFields\n\nsfc_emis: Surface emissivity [W/m²] (nbnd, ncol)\ninc_flux: incident flux at top of atmosphere [W/m²] (ncol, ngpt)\n\n\n\n\n\n","category":"type"},{"location":"optics/BCs/#RRTMGP.BCs.SwBCs","page":"Boundary Conditions","title":"RRTMGP.BCs.SwBCs","text":"SwBCs{FT,FTA1D}\n\nShortwave boundary conditions\n\nFields\n\ncos_zenith: cosine of zenith angle (ncol)\ntoa_flux: top of atmosphere flux (ncol)\nsfc_alb_direct: surface albedo for specular (direct) radiation (nbnd, ncol)\ninc_flux_diffuse: incident diffuse flux at top of domain [W/m2] (ncol, ngpt)\nsfc_alb_diffuse: surface albedo for diffuse radiation (nbnd, ncol)\n\n\n\n\n\n","category":"type"},{"location":"optics/AtmosphericStates/#Atmospheric-State","page":"Atmospheric State","title":"Atmospheric State","text":"","category":"section"},{"location":"optics/AtmosphericStates/","page":"Atmospheric State","title":"Atmospheric State","text":"CurrentModule = RRTMGP.AtmosphericStates","category":"page"},{"location":"optics/AtmosphericStates/","page":"Atmospheric State","title":"Atmospheric State","text":"AtmosphericState\nGrayAtmosphericState\nGrayOpticalThicknessSchneider2004\nGrayOpticalThicknessOGorman2008","category":"page"},{"location":"optics/AtmosphericStates/#RRTMGP.AtmosphericStates.AtmosphericState","page":"Atmospheric State","title":"RRTMGP.AtmosphericStates.AtmosphericState","text":"AtmosphericState{FT,FTA1D,FTA1DN,FTA2D,CLDP,CLDM,VMR} <:\n    AbstractAtmosphericState{FT,FTA1D}\n\nAtmospheric conditions, used to compute optical properties. \n\nFields\n\nlon: longitude, in degrees (ncol), optional\nlat: latitude, in degrees (ncol), optional\np_lay: Layer pressures [Pa, mb]; (nlay,ncol)\np_lev: Level pressures [Pa, mb]; (nlay+1,ncol)\nt_lay: Layer temperatures [K]; (nlay,ncol)\nt_lev: Level temperatures [K]; (nlay+1,ncol)\nt_sfc: Surface temperatures [K]; (ncol)\ncol_dry: Number of molecules per cm^2 of dry air (nlay, ncol)\nvmr: volume mixing ratio of all relevant gases\ncld_r_eff_liq: effective radius of cloud liquid particles\ncld_r_eff_ice: effective radius of cloud ice particles\ncld_path_liq: cloud water path\ncld_path_ice: cloud ice path\ncld_frac: cloud fraction\ncld_mask_lw: cloud mask (longwave), = true if clouds are present\ncld_mask_sw: cloud mask (shortwave), = true if clouds are present\ncld_mask_type: cloud mask type\nice_rgh: ice roughness, 1 = none, 2 = medium, 3 = rough\nnlay: Number of layers.\nncol: Number of columns.\nngas: Number of gases.\n\n\n\n\n\n","category":"type"},{"location":"optics/AtmosphericStates/#RRTMGP.AtmosphericStates.GrayAtmosphericState","page":"Atmospheric State","title":"RRTMGP.AtmosphericStates.GrayAtmosphericState","text":"GrayAtmosphericState{FT,FTA1D,FTA2D} <: \n    AbstractAtmosphericState{FT,FTA1D}\n\nAtmospheric conditions, used to compute optical properties with the gray atmosphere approximation\n\nFields\n\nlat: latitude, in degrees, for each column; (ncol,)\np_lay: Layer pressures [Pa, mb]; (nlay, ncol)\np_lev: Level pressures [Pa, mb]; (nlay+1, ncol)\nt_lay: Layer temperatures [K]; (nlay, ncol)\nt_lev: Level temperatures [K]; (nlay+1,ncol)\nz_lev: Level Altitude [m]; (nlay+1,ncol)\nt_sfc: Surface temperatures [K]; (ncol)\notp: optical thickness parameters\nnlay: Number of layers.\nncol: Number of columns.\n\n\n\n\n\n","category":"type"},{"location":"optics/AtmosphericStates/#RRTMGP.AtmosphericStates.GrayOpticalThicknessSchneider2004","page":"Atmospheric State","title":"RRTMGP.AtmosphericStates.GrayOpticalThicknessSchneider2004","text":"GrayOpticalThicknessSchneider2004{FT} <: AbstractGrayOpticalThickness\n\nOptical thickness function parameters from Schneider 2004, J. Atmos. Sci. (2004) 61 (12): 1317–1340. DOI: https://doi.org/10.1175/1520-0469(2004)061<1317:TTATTS>2.0.CO;2\n\nFields\n\nα: scaling height ratio\nte: global mean surface temperature (K)\ntt: temp at top of atmosphere (K)\nΔt: Δt (K)\n\n\n\n\n\n","category":"type"},{"location":"optics/AtmosphericStates/#RRTMGP.AtmosphericStates.GrayOpticalThicknessOGorman2008","page":"Atmospheric State","title":"RRTMGP.AtmosphericStates.GrayOpticalThicknessOGorman2008","text":"GrayOpticalThicknessOGorman2008{FT} <: AbstractGrayOpticalThickness\n\nOptical thickness function parameters from O'Gorman 2008, Journal of Climate Vol 21, Page(s): 3815–3832. DOI: https://doi.org/10.1175/2007JCLI2065.1\n\nFields\n\nα: scaling factor\nfₗ: fₗ\nτₑ: longwave optical thickness at equator\nτₚ: longwave optical thickness at poles\nτ₀: optical thickness for shortwave radiation\n\n\n\n\n\n","category":"type"},{"location":"optics/Vmrs/#Volume-Mixing-Ratios","page":"Volume Mixing Ratios","title":"Volume Mixing Ratios","text":"","category":"section"},{"location":"optics/Vmrs/","page":"Volume Mixing Ratios","title":"Volume Mixing Ratios","text":"CurrentModule = RRTMGP.Vmrs","category":"page"},{"location":"optics/Vmrs/","page":"Volume Mixing Ratios","title":"Volume Mixing Ratios","text":"AbstractVmr\nVmr\nVmrGM\ninit_vmr\nget_vmr","category":"page"},{"location":"optics/Vmrs/#RRTMGP.Vmrs.AbstractVmr","page":"Volume Mixing Ratios","title":"RRTMGP.Vmrs.AbstractVmr","text":"AbstractVmr{FT}\n\n\n\n\n\n","category":"type"},{"location":"optics/Vmrs/#RRTMGP.Vmrs.Vmr","page":"Volume Mixing Ratios","title":"RRTMGP.Vmrs.Vmr","text":"Vmr{FT,FTA3D} <: AbstractVmr{FT}\n\nVolume mixing ratios for various gases in the atmosphere. This struct can be used when concentrations vary spatially for all gases.\n\nFields\n\nvmr: volume mixing ratio of all gases as a function of location and column\n\n\n\n\n\n","category":"type"},{"location":"optics/Vmrs/#RRTMGP.Vmrs.VmrGM","page":"Volume Mixing Ratios","title":"RRTMGP.Vmrs.VmrGM","text":"VmrGM{FT,FTA1D,FTA2D} <: AbstractVmr{FT}\n\nVolume mixing ratios for various gases in the atmosphere. This struct can be used when only H₂O and O₃ concentrations vary spatially and a global mean is used  for all other gases.\n\nFields\n\nvmr_h2o: volume mixing ratio of H₂O\nvmr_o3: volume mixing ratio of Ozone\nvmr: volume mixing ratio of all other gases, which are independent of location and column\n\n\n\n\n\n","category":"type"},{"location":"optics/Vmrs/#RRTMGP.Vmrs.init_vmr","page":"Volume Mixing Ratios","title":"RRTMGP.Vmrs.init_vmr","text":"init_vmr(\n    ngas,\n    nlay,\n    ncol,\n    ::Type{FT},\n    ::Type{DA};\n    gm::Bool = true,\n) where {FT<:AbstractFloat,DA}\n\nInitialize the Vmr struct.\n\n\n\n\n\n","category":"function"},{"location":"optics/Vmrs/#RRTMGP.Vmrs.get_vmr","page":"Volume Mixing Ratios","title":"RRTMGP.Vmrs.get_vmr","text":"get_vmr(\n    vmr::VmrGM{FT},\n    ig::Int,\n    ilay::Int,\n    icol::Int,\n) where {FT<:AbstractFloat}\n\nObtain volume mixing ratio of gas ig for layer ilay of column icol.\n\n\n\n\n\nget_vmr(\n    vmr::Vmr{FT},\n    ig::Int,\n    ilay::Int,\n    icol::Int,\n) where {FT<:AbstractFloat}\n\nObtain volume mixing ratio of gas ig for layer ilay of column icol.\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#Optics","page":"Optics","title":"Optics","text":"","category":"section"},{"location":"optics/Optics/","page":"Optics","title":"Optics","text":"CurrentModule = RRTMGP.Optics","category":"page"},{"location":"optics/Optics/","page":"Optics","title":"Optics","text":"AbstractOpticalProps\nOneScalar\nTwoStream\ncompute_col_gas!\ncompute_optical_props!","category":"page"},{"location":"optics/Optics/#RRTMGP.Optics.AbstractOpticalProps","page":"Optics","title":"RRTMGP.Optics.AbstractOpticalProps","text":"AbstractOpticalProps{FT,FTA2D}\n\nOptical properties for one scalar and two stream calculations.\n\n\n\n\n\n","category":"type"},{"location":"optics/Optics/#RRTMGP.Optics.OneScalar","page":"Optics","title":"RRTMGP.Optics.OneScalar","text":"OneScalar{FT,FTA1D,FTA2D,AD} <: AbstractOpticalProps{FT,FTA2D}\n\nSingle scalar approximation for optical depth, used in calculations accounting for extinction and emission\n\nFields\n\nτ: Optical Depth\nangle_disc: Angular discretization\n\n\n\n\n\n","category":"type"},{"location":"optics/Optics/#RRTMGP.Optics.TwoStream","page":"Optics","title":"RRTMGP.Optics.TwoStream","text":"TwoStream{FT,FTA2D} <: AbstractOpticalProps{FT,FTA2D}\n\nTwo stream approximation for optical properties, used in calculations accounting for extinction and emission\n\nFields\n\nτ: Optical depth\nssa: Single-scattering albedo\ng: Asymmetry parameter\n\n\n\n\n\n","category":"type"},{"location":"optics/Optics/#RRTMGP.Optics.compute_col_gas!","page":"Optics","title":"RRTMGP.Optics.compute_col_gas!","text":"compute_col_gas!(\n    context,\n    p_lev,\n    col_dry,\n    param_set,\n    vmr_h2o,\n    lat,\n    max_threads = Int(256),\n)\n\nThis function computes the column amounts of dry or moist air.\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#RRTMGP.Optics.compute_optical_props!","page":"Optics","title":"RRTMGP.Optics.compute_optical_props!","text":"compute_optical_props!(\n    op::AbstractOpticalProps{FT},\n    as::AtmosphericState{FT},\n    sf::AbstractSourceLW{FT},\n    gcol::Int,\n    igpt::Int,\n    lkp::LookUpLW{FT},\n    lkp_cld::Union{LookUpCld,PadeCld,Nothing} = nothing,\n) where {FT<:AbstractFloat}\n\nComputes optical properties for the longwave problem.\n\n\n\n\n\ncompute_optical_props!(\n    op::AbstractOpticalProps{FT},\n    as::AtmosphericState{FT},\n    gcol::Int,\n    igpt::Int,\n    lkp::LookUpSW{FT},\n    lkp_cld::Union{LookUpCld,PadeCld,Nothing} = nothing,\n) where {FT<:AbstractFloat}\n\nComputes optical properties for the shortwave problem.\n\n\n\n\n\ncompute_optical_props!(\n    op::AbstractOpticalProps{FT},\n    as::GrayAtmosphericState{FT},\n    sf::AbstractSourceLW{FT},\n    gcol::Int,\n    igpt::Int = 1,\n) where {FT<:AbstractFloat}\n\nComputes optical properties for the longwave gray radiation problem.\n\n\n\n\n\ncompute_optical_props!(\n    op::AbstractOpticalProps{FT},\n    as::GrayAtmosphericState{FT},\n    gcol::Int,\n    igpt::Int = 1,\n) where {FT<:AbstractFloat}\n\nComputes optical properties for the shortwave gray radiation problem.\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/","page":"Optics","title":"Optics","text":"compute_col_gas_kernel!\ncompute_interp_frac_temp\ncompute_interp_frac_press\ncompute_interp_frac_η\ncompute_gas_optics\ncompute_τ_minor\ncompute_τ_rayleigh\ncompute_lw_planck_src!","category":"page"},{"location":"optics/Optics/#RRTMGP.Optics.compute_col_gas_kernel!","page":"Optics","title":"RRTMGP.Optics.compute_col_gas_kernel!","text":"compute_col_gas_kernel!(\n    col_gas,\n    p_lev,\n    mol_m_dry,\n    mol_m_h2o,\n    avogadro\n    helmert1,\n    vmr_h2o\n    lat,\n    glay, gcol,\n)\n\nThis function computes the column amounts of dry or moist air.\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#RRTMGP.Optics.compute_interp_frac_temp","page":"Optics","title":"RRTMGP.Optics.compute_interp_frac_temp","text":"compute_interp_frac_temp(Δ_t_ref, n_t_ref, t_ref, t_lay)\n\ncompute interpolation fraction for temperature.\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#RRTMGP.Optics.compute_interp_frac_press","page":"Optics","title":"RRTMGP.Optics.compute_interp_frac_press","text":"compute_interp_frac_press(\n    lkp::AbstractLookUp,\n    p_lay,\n    tropo,\n    glay,\n    gcol,\n)\n\nCompute interpolation fraction for pressure.\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#RRTMGP.Optics.compute_interp_frac_η","page":"Optics","title":"RRTMGP.Optics.compute_interp_frac_η","text":"compute_interp_frac_η(\n    lkp::AbstractLookUp,\n    vmr,\n    tropo,\n    jtemp,\n    ibnd,\n    glay,\n    gcol,\n)\n\nCompute interpolation fraction for binary species parameter.\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#RRTMGP.Optics.compute_gas_optics","page":"Optics","title":"RRTMGP.Optics.compute_gas_optics","text":"compute_gas_optics(\n    lkp::Union{LookUpLW, LookUpSW},\n    vmr,\n    col_dry,\n    igpt,\n    ibnd,\n    p_lay::FT,\n    t_lay,\n    glay, gcol,\n) where {FT<:AbstractFloat}\n\nCompute optical thickness, single scattering albedo, and asymmetry parameter.\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#RRTMGP.Optics.compute_τ_minor","page":"Optics","title":"RRTMGP.Optics.compute_τ_minor","text":"compute_τ_minor(\n    lkp::AbstractLookUp,\n    tropo::Int,\n    vmr,\n    vmr_h2o::FT,\n    col_dry,\n    p_lay::FT,\n    t_lay::FT,\n    jtemp::Int,\n    ftemp::FT,\n    jη1::Int,\n    jη2::Int,\n    fη1::FT,\n    fη2::FT,\n    igpt,\n    ibnd,\n    glay,\n    gcol,\n) where {FT<:AbstractFloat}\n\nCompute optical thickness contributions from minor gases.\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#RRTMGP.Optics.compute_τ_rayleigh","page":"Optics","title":"RRTMGP.Optics.compute_τ_rayleigh","text":"compute_τ_rayleigh(\n    lkp::LookUpSW,\n    tropo::Int,\n    col_dry::FT,\n    vmr_h2o::FT,\n    jtemp::Int,\n    ftemp::FT,\n    jη1::Int,\n    jη2::Int,\n    fη1::FT,\n    fη2::FT,\n    igpt::Int,\n) where {FT<:AbstractFloat}\n\nCompute Rayleigh scattering optical depths for shortwave problem\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#RRTMGP.Optics.compute_lw_planck_src!","page":"Optics","title":"RRTMGP.Optics.compute_lw_planck_src!","text":"compute_lw_planck_src!(lkp::LookUpLW, vmr, p_lay, t_lay, igpt, ibnd, glay, gcol, t_target)\n\nComputes Planck sources for the longwave problem.\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/","page":"Optics","title":"Optics","text":"build_cloud_mask!\nadd_cloud_optics_2stream\ncompute_cld_props\npade_eval","category":"page"},{"location":"optics/Optics/#RRTMGP.Optics.build_cloud_mask!","page":"Optics","title":"RRTMGP.Optics.build_cloud_mask!","text":"build_cloud_mask!(cld_mask, cld_frac, ::MaxRandomOverlap)\n\nBuilds McICA-sampled cloud mask from cloud fraction data for maximum-random overlap\n\nReference: https://github.com/AER-RC/RRTMG_SW/\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#RRTMGP.Optics.add_cloud_optics_2stream","page":"Optics","title":"RRTMGP.Optics.add_cloud_optics_2stream","text":"add_cloud_optics_2stream(\n    τ,\n    ssa,\n    g,\n    cld_mask,\n    cld_r_eff_liq,\n    cld_r_eff_ice,\n    cld_path_liq,\n    cld_path_ice,\n    ice_rgh,\n    lkp_cld,\n    ibnd;\n    delta_scaling = false,\n)\n\nThis function computes the TwoStream clouds optics properties and adds them to the TwoStream gas optics properties.\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#RRTMGP.Optics.compute_cld_props","page":"Optics","title":"RRTMGP.Optics.compute_cld_props","text":"compute_cld_props(\n    lkp_cld::LookUpCld,\n    re_liq::FT,\n    re_ice::FT,\n    ice_rgh::Int,\n    cld_path_liq::FT,\n    cld_path_ice::FT,\n    ibnd::UInt8,\n) where {FT}\n\nThis function computed the TwoSteam cloud optics properties using either the  lookup table method or pade method.\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#RRTMGP.Optics.pade_eval","page":"Optics","title":"RRTMGP.Optics.pade_eval","text":"pade_eval(\n    ibnd,\n    re,\n    irad,\n    m,\n    n,\n    pade_coeffs,\n    irgh::Union{Int,Nothing} = nothing,\n)\n\nEvaluate Pade approximant of order [m/n]\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/","page":"Optics","title":"Optics","text":"compute_optical_props_kernel!\ncompute_optical_props_kernel_lw!\ncompute_sources_gray_kernel!\ncompute_gray_optical_thickness_lw\ncompute_gray_optical_thickness_sw","category":"page"},{"location":"optics/Optics/#RRTMGP.Optics.compute_optical_props_kernel!","page":"Optics","title":"RRTMGP.Optics.compute_optical_props_kernel!","text":"compute_optical_props_kernel!(\n    op::AbstractOpticalProps{FT},\n    as::GrayAtmosphericState{FT},\n    glay, gcol,\n    source::AbstractSourceLW{FT},\n) where {FT<:AbstractFloat}\n\nThis function computes the optical properties using the gray atmosphere assumption for the longwave solver.\n\n\n\n\n\ncompute_optical_props_kernel!(\n    op::AbstractOpticalProps{FT},\n    as::GrayAtmosphericState{FT},\n    glay, gcol,\n) where {FT<:AbstractFloat}\n\nThis function computes the optical properties using the gray atmosphere assumption for the shortwave solver.\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#RRTMGP.Optics.compute_optical_props_kernel_lw!","page":"Optics","title":"RRTMGP.Optics.compute_optical_props_kernel_lw!","text":"compute_optical_props_kernel!(\n    op::AbstractOpticalProps{FT},\n    as::GrayAtmosphericState{FT},\n    glay, gcol,\n) where {FT<:AbstractFloat}\n\nThis function computes the optical properties using the gray atmosphere assumption for the longwave solver.\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#RRTMGP.Optics.compute_sources_gray_kernel!","page":"Optics","title":"RRTMGP.Optics.compute_sources_gray_kernel!","text":"compute_sources_gray_kernel!(\n    source::AbstractSourceLW{FT},\n    as::GrayAtmosphericState{FT},\n    glay, gcol,\n) where {FT<:AbstractFloat}\n\nThis function computes the Planck sources for the gray longwave solver.\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#RRTMGP.Optics.compute_gray_optical_thickness_lw","page":"Optics","title":"RRTMGP.Optics.compute_gray_optical_thickness_lw","text":"compute_gray_optical_thickness_lw(\n    params::GrayOpticalThicknessSchneider2004{FT},\n    glay, gcol,\n    p0,\n    Δp,\n    p,\n    lat,\n) where {FT<:AbstractFloat}\n\nThis functions calculates the optical thickness based on pressure  and lapse rate for a gray atmosphere.  See Schneider 2004, J. Atmos. Sci. (2004) 61 (12): 1317–1340. DOI: https://doi.org/10.1175/1520-0469(2004)061<1317:TTATTS>2.0.CO;2\n\n\n\n\n\ncompute_gray_optical_thickness_lw(\n    params::GrayOpticalThicknessOGorman2008{FT},\n    glay, gcol,\n    p0,\n    Δp,\n    p,\n    lat,\n) where {FT}\n\nThis functions calculates the optical thickness based on pressure  and lapse rate for a gray atmosphere.  See O'Gorman 2008, Journal of Climate Vol 21, Page(s): 3815–3832. DOI: https://doi.org/10.1175/2007JCLI2065.1\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#RRTMGP.Optics.compute_gray_optical_thickness_sw","page":"Optics","title":"RRTMGP.Optics.compute_gray_optical_thickness_sw","text":"compute_gray_optical_thickness_sw(\n    params::GrayOpticalThicknessOGorman2008{FT},\n    glay, gcol,\n    p0,\n    Δp,\n    p,\n    rest...,\n) where {FT}\n\nThis functions calculates the optical thickness based on pressure  for a gray atmosphere.  See O'Gorman 2008, Journal of Climate Vol 21, Page(s): 3815–3832. DOI: https://doi.org/10.1175/2007JCLI2065.1\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/","page":"Optics","title":"Optics","text":"interp1d\ninterp2d\ninterp3d\nincrement_2stream\ndelta_scale","category":"page"},{"location":"optics/Optics/#RRTMGP.Optics.interp1d","page":"Optics","title":"RRTMGP.Optics.interp1d","text":"interp1d(xi::FT, x, y, col) where {FT<:AbstractFloat}\n\nperform 1D linear interpolation.\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#RRTMGP.Optics.interp2d","page":"Optics","title":"RRTMGP.Optics.interp2d","text":"interp2d(\n    fη1::FT,\n    fη2::FT,\n    ftemp::FT,\n    coeff::FTA3D,\n    igpt::Int,\n    jη1::Int,\n    jη2::Int,\n    jtemp::Int,\n) where {FT<:AbstractFloat,FTA3D<:AbstractArray{FT,3}}\n\nPerform 2D linear interpolation.\n\nfminor[1, 1] = (FT(1) - fη1) * (1-ftemp)\n\nfminor[2, 1] = fη1 * (1-ftemp)\n\nfminor[1, 2] = (FT(1) - fη2) * ftemp\n\nfminor[2, 2] = fη2 * ftemp\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#RRTMGP.Optics.interp3d","page":"Optics","title":"RRTMGP.Optics.interp3d","text":"interp3d(\n    jη1::Int,\n    jη2::Int,\n    fη1::FT,\n    fη2::FT,\n    jtemp::Int,\n    ftemp::FT,\n    jpresst::Int,\n    fpress::FT,\n    coeff::FTA4D,\n    igpt::Int,\n    s1::FT = FT(1),\n    s2::FT = FT(1),\n) where {FT<:AbstractFloat,FTA4D<:AbstractArray{FT,4}}\n\nPerform 3D linear interpolation.\n\nfmajor[1, 1, itemp] = (FT(1) - fpress) * fminor[1, itemp]\n\nfmajor[2, 1, itemp] = (FT(1) - fpress) * fminor[2, itemp]\n\nfmajor[1, 2, itemp] = fpress * fminor[1, itemp]\n\nfmajor[2, 2, itemp] = fpress * fminor[2, itemp]\n\nwhere,\n\nfminor[1, itemp=1] = (FT(1) - fη1) * (1-ftemp)\n\nfminor[2, itemp=1] = fη1 * (1-ftemp)\n\nfminor[1, itemp=2] = (FT(1) - fη2) * ftemp\n\nfminor[2, itemp=2] = fη2 * ftemp\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#RRTMGP.Optics.increment_2stream","page":"Optics","title":"RRTMGP.Optics.increment_2stream","text":"increment_2stream!(τ1::FT, ssa1::FT, g1::FT, τ2::FT, ssa2::FT, g2::FT) where {FT}\n\nIncrement TwoStream optical properties τ1, ssa1 and g1  with τ2, ssa2 and g2. Here τ is the optical thickness, ssa is the single-scattering albedo, and g is the symmetry parameter.\n\n\n\n\n\n","category":"function"},{"location":"optics/Optics/#RRTMGP.Optics.delta_scale","page":"Optics","title":"RRTMGP.Optics.delta_scale","text":"delta_scale(τ, ssa, g)\n\ndelta-scale two stream optical properties.\n\n\n\n\n\n","category":"function"},{"location":"RTE/#Radiatve-Transfer-Equations","page":"RTE","title":"Radiatve Transfer Equations","text":"","category":"section"},{"location":"RTE/#Radiation-heating-rate","page":"RTE","title":"Radiation heating rate","text":"","category":"section"},{"location":"RTE/","page":"RTE","title":"RTE","text":"Radiative fluxes enter the thermal energy equation as follows:","category":"page"},{"location":"RTE/","page":"RTE","title":"RTE","text":"beginalign\npartial_t (rho e) = - nabla cdot F_net\nendalign","category":"page"},{"location":"RTE/","page":"RTE","title":"RTE","text":"where F_net = sum_j (F^+_j - F^-_j), and F^+_j and F^-_j denote the sum of shortwave and longwave upward and downward fluxes for spectral interval j, respectively.","category":"page"},{"location":"RTE/#RTE-solver","page":"RTE","title":"RTE solver","text":"","category":"section"},{"location":"RTE/","page":"RTE","title":"RTE","text":"solve_lw! and solve_sw! solve the radiative transfor equation for longwave and shortwave radiation.","category":"page"},{"location":"RTE/","page":"RTE","title":"RTE","text":"note: Note\nWe have both no scattering and two stream solvers in the code. Only two stream solver is documented here.","category":"page"},{"location":"RTE/#Computing-fluxes-through-a-vertically-layered-atmosphere","page":"RTE","title":"Computing fluxes through a vertically layered atmosphere","text":"","category":"section"},{"location":"RTE/","page":"RTE","title":"RTE","text":"adding_lw! and rte_sw_2stream! compute longwave and shortwave radiative fluxes through a vertically layered atmosphere. The equations for upward and downward fluxes are calculated following [1]:","category":"page"},{"location":"RTE/","page":"RTE","title":"RTE","text":"beginalign\nF^+_i = alpha_i F^-_i + G_i \nF^-_i = beta_i (T_i F^-_i+1 + R_i G_i + S^-_i) + F^-_i dir \nalpha_i+1 = R_i + T_i^2 beta_i alpha_i \nG_i+1 = S^+_i + T_i beta_i (G_i + alpha_i S^-_i) \nendalign","category":"page"},{"location":"RTE/","page":"RTE","title":"RTE","text":"where beta_k = 1  (1 - alpha_k R_k). T and R are transmittance and reflectance, and S^+ and S^- represent upward and downward source functions. F^-_dir is the downward direct shortwave flux. The subscript i represents the level.","category":"page"},{"location":"RTE/#Computing-transmittance,-reflectance,-and-total-source-functions","page":"RTE","title":"Computing transmittance, reflectance, and total source functions","text":"","category":"section"},{"location":"RTE/#Longwave","page":"RTE","title":"Longwave","text":"","category":"section"},{"location":"RTE/","page":"RTE","title":"RTE","text":"rte_lw_2stream_source! calculates transmittance (T), reflectance (R), and source functions (S^+ and S^-) from optical properties for longwave radiation. Transmittance and reflectance are calculated following [2]:","category":"page"},{"location":"RTE/","page":"RTE","title":"RTE","text":"beginalign\nT = frac2 k e^-k tauk + gamma 1 + (k - gamma_1) e^-2 k tau \nR = fracgamma_2 (1 - e^-2 k tau)k + gamma 1 + (k - gamma_1) e^-2 k tau\nendalign","category":"page"},{"location":"RTE/","page":"RTE","title":"RTE","text":"where tau is the optical depth, and k = sqrtgamma_1^2 - gamma_2^2. gamma_1 and gamma_2 are coupling coefficients in the two-stream approximation that describe how isotropic the phase function is, and are determined by the optical properties (single scattering albedo and asymmetry parameter).","category":"page"},{"location":"RTE/","page":"RTE","title":"RTE","text":"S^+ and S^- are calculated from optical properties and Planck source functions following [3].","category":"page"},{"location":"RTE/#Shortwave","page":"RTE","title":"Shortwave","text":"","category":"section"},{"location":"RTE/","page":"RTE","title":"RTE","text":"sw_2stream_coeffs calculates diffuse transmittance (T), diffuse reflectance (R), direct transmittance (T_dir), and direct reflectance (R_dir) from optical properties for shortwave radiation. T and R are calculated following the same equations as for the longwave radiation. T_dir and R_dir is calculated following [2]:","category":"page"},{"location":"RTE/","page":"RTE","title":"RTE","text":"beginalign\nT_dir = - A ((1 + k mu) (alpha_1 + k gamma_4) e^-taumu - (1 - k mu) (alpha_1 - k gamma_4) e^-2ktau e^-taumu - 2k (gamma_4 + alpha_1 mu) e^-taumu) \nR_dir = A ((1 - k mu) (alpha_2 + k gamma_3) - (1 + k mu) (alpha_2 - k gamma_3) e^-2 k tau - 2 (k gamma_3 - alpha_2 k mu) e^-k tau  e^-taumu)\nendalign","category":"page"},{"location":"RTE/","page":"RTE","title":"RTE","text":"where A = omega_0  (1 - k^2 mu^2)  (k (1 + e^-2 k tau) + gamma_1 (1 - e^-2 k tau)). omega_0 is the single scattering albedo. mu is the cosine of solar zenith angle. gamma_3, and gamma_4 are coefficients in the two-stream approximation and determined by the optical properties. They are constrained to gamma_3 + gamma_4 = 1 by energy conservation.","category":"page"},{"location":"RTE/","page":"RTE","title":"RTE","text":"The direct downward flux (F^-_dir) and source functions (S^+ and S^-) for each level are calculated from T_dir and R_dir:","category":"page"},{"location":"RTE/","page":"RTE","title":"RTE","text":"beginalign\nF^-_dir i = e^-taumu F^-_dir i+1 \nS^+_i = R_dir i F^-_dir i+1 \nS^-_i = T_dir i F^-_dir i+1\nendalign","category":"page"},{"location":"References/#References","page":"References","title":"References","text":"","category":"section"},{"location":"References/","page":"References","title":"References","text":"J. K. Shonk and R. J. Hogan. Tripleclouds: An efficient method for representing horizontal cloud inhomogeneity in 1D radiation schemes by using three regions at each height. Journal of Climate 21, 2352–2370 (2008).\n\n\n\nW. Meador and W. Weaver. Two-stream approximations to radiative transfer in planetary atmospheres: A unified description of existing methods and a new improvement. Journal of Atmospheric Sciences 37, 630–643 (1980).\n\n\n\nO. B. Toon, C. McKay, T. Ackerman and K. Santhanam. Rapid calculation of radiative heating rates and photodissociation rates in inhomogeneous multiple scattering atmospheres. Journal of Geophysical Research: Atmospheres 94, 16287–16301 (1989).\n\n\n\nT. Schneider. The tropopause and the thermal stratification in the extratropics of a dry atmosphere. Journal of the Atmospheric Sciences 61, 1317–1340 (2004).\n\n\n\nP. A. O’Gorman and T. Schneider. The hydrological cycle over a wide range of climates simulated with an idealized GCM. Journal of Climate 21, 3815–3832 (2008).\n\n\n\nD. M. Frierson. The dynamics of idealized convection schemes and their effect on the zonally averaged tropical circulation. Journal of the Atmospheric Sciences 64, 1959–1976 (2007).\n\n\n\nR. Pincus, E. J. Mlawer and J. S. Delamere. Balancing accuracy, efficiency, and flexibility in radiation calculations for dynamical models. Journal of Advances in Modeling Earth Systems 11, 3074–3089 (2019).\n\n\n\nP. Yang, L. Bi, B. A. Baum, K.-N. Liou, G. W. Kattawar, M. I. Mishchenko and B. Cole. Spectrally consistent scattering, absorption, and polarization properties of atmospheric ice crystals at wavelengths from 0.2 to 100 mu m. Journal of the atmospheric sciences 70, 330–347 (2013).\n\n\n\nJ. H. Joseph, W. Wiscombe and J. Weinman. The delta-Eddington approximation for radiative flux transfer. Journal of Atmospheric Sciences 33, 2452–2459 (1976).\n\n\n\n","category":"page"},{"location":"Example/#Example","page":"Example","title":"Example","text":"","category":"section"},{"location":"Example/","page":"Example","title":"Example","text":"A suite of concrete examples are provided here as a guidance for using RRTMGP. The example code is in the test folder. ","category":"page"},{"location":"Example/#Gray-radiation","page":"Example","title":"Gray radiation","text":"","category":"section"},{"location":"Example/","page":"Example","title":"Example","text":"gray_atm.jl tests longwave and shortwave gray radiation. For longwave-only gray radiation (i.e., an atmosphere transparent to solar radiation), an analytical solution exists for the radiative equilibrium. gray_atmos_lw_equil computes radiative equilibrium with longwave-only gray radiation and compares the result against the analytical solution.","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"julia> include(\"test/gray_atm.jl\")\njulia> gray_atmos_lw_equil(TwoStream, Float64, Int, DA, Int(1))\n*************************************************\nLongwave test for gray atmosphere model - TwoStream; ncol = 1; DA = Array\nIntegration time = 40.0 years\nt_error = 0.006105025574186129; flux_grad_err = 9.999832315088497e-6\nTest Passed","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"Here is the vertical profile of temperature (T_ex_lev) in radiative equilibrium:","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"(Image: )","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"gray_atmos_sw_test computes radiative fluxes with shortwave-only gray radiation and compares the result to the exact solution.","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"julia> include(\"test/gray_atm.jl\")\njulia> gray_atmos_sw_test(TwoStream, Float64, Int, DA, Int(1))\n*************************************************\nRunning shortwave test for gray atmosphere model - TwoStream; ncol = 1; DA = Array\nrelative error = 5.776373821376071e-16\nTest Passed","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"Here is the vertical profile of the downward shortwave radiative flux (flux_dn_dir):","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"(Image: )","category":"page"},{"location":"Example/#Gas-optics","page":"Example","title":"Gas optics","text":"","category":"section"},{"location":"Example/","page":"Example","title":"Example","text":"clear_sky.jl runs RRTMGP for specific clear-sky atmosphere states and compares the results to reference data. The atmosphere states and reference data are stored in netcdf files here.","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"julia> include(\"test/clear_sky.jl\")\njulia> clear_sky(TwoStream, SourceLW2Str, VmrGM, Float64, Int, array_type())\ncalling longwave solver; ncol = 100\n  0.597229 seconds (1.54 k allocations: 344.438 KiB)\ncalling shortwave solver; ncol = 100\n  0.449502 seconds (1.34 k allocations: 283.938 KiB)\n=======================================\nClear-sky longwave test - TwoStream\nmax_err_flux_up_lw = 1.611013158253627e-5\nmax_err_flux_dn_lw = 1.6820160510633286e-5\nClear-sky shortwave test, opc  = TwoStream\nmax_err_flux_up_sw = 4.354144800799986e-5\nmax_err_flux_dn_sw = 0.00018220861784357112\n=======================================\nTest Passed","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"Here are the vertical profiles of downward longwave (flux_dn_lw) and shortwave (flux_dn_sw) fluxes for the first column:","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"(Image: ) (Image: )","category":"page"},{"location":"Example/#Cloud-optics","page":"Example","title":"Cloud optics","text":"","category":"section"},{"location":"Example/","page":"Example","title":"Example","text":"all_sky.jl runs RRTMGP for specific all-sky atmosphere states with arbitrary clouds and compares the results to reference data. The atmosphere states and reference data are stored in netcdf files here. The clouds are very idealized, with uniform condensate and particle size everywhere in the troposphere (though with different values for liquid and ice). Fractional cloudiness is not considered.","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"julia> include(\"test/all_sky.jl\")\njulia> all_sky(TwoStream, Float64, Int, DA, use_lut = true, cldfrac = Float64(1))\ncalling longwave solver; ncol = 128\n  1.357532 seconds (141.42 k allocations: 7.896 MiB, 25.54% compilation time: 100% of which was recompilation)\ncalling shortwave solver; ncol = 128\n  0.834152 seconds (60.46 k allocations: 3.683 MiB, 39.67% compilation time: 100% of which was recompilation)\n=======================================\nCloudy-sky longwave test - TwoStream\nLookup Table Interpolation method\nmax_err_flux_up_lw = 8.359090770682087e-7\nmax_err_flux_dn_lw = 1.7562185803399188e-6\nCloudy-sky shortwave test - TwoStream\nLookup Table Interpolation method\nmax_err_flux_up_sw = 4.038832912556245e-8\nmax_err_flux_dn_sw = 1.6986234641080955e-7\n=======================================\nTest Passed","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"Here are the vertical profiles of downward longwave (flux_dn_lw) and shortwave (flux_dn_sw) fluxes for the first column:","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"(Image: ) (Image: )","category":"page"},{"location":"optics/AngularDiscretizations/#Angular-Discretizations","page":"Angular Discretization","title":"Angular Discretizations","text":"","category":"section"},{"location":"optics/AngularDiscretizations/","page":"Angular Discretization","title":"Angular Discretization","text":"CurrentModule = RRTMGP.AngularDiscretizations","category":"page"},{"location":"optics/AngularDiscretizations/","page":"Angular Discretization","title":"Angular Discretization","text":"AngularDiscretization","category":"page"},{"location":"optics/AngularDiscretizations/#RRTMGP.AngularDiscretizations.AngularDiscretization","page":"Angular Discretization","title":"RRTMGP.AngularDiscretizations.AngularDiscretization","text":"AngularDiscretization{FT,FTA1D}\n\nWeights and angle secants for first order (k=1) Gaussian quadrature. Values from Table 2, Clough et al, 1992, doi:10.1029/92JD01419 after Abramowitz & Stegun 1972, page 921\n\nFields\n\nn_gauss_angles: number of quadrature angles\ngauss_Ds: quadrature secants / secant of propagation angle\ngauss_wts: quadrature weights\n\n\n\n\n\n","category":"type"},{"location":"optics/Sources/#Source-Functions","page":"Source Functions","title":"Source Functions","text":"","category":"section"},{"location":"optics/Sources/","page":"Source Functions","title":"Source Functions","text":"CurrentModule = RRTMGP.Sources","category":"page"},{"location":"optics/Sources/","page":"Source Functions","title":"Source Functions","text":"AbstractSourceLW\nSourceLWNoScat\nSourceLW2Str\nSourceSW2Str\nsource_func_longwave\nsource_func_shortwave","category":"page"},{"location":"optics/Sources/#RRTMGP.Sources.AbstractSourceLW","page":"Source Functions","title":"RRTMGP.Sources.AbstractSourceLW","text":"AbstractSourceLW{FT,FTA1D,FTA2D}\n\nAbstract longwave source for no-scattering and two stream longwave solvers.\n\n\n\n\n\n","category":"type"},{"location":"optics/Sources/#RRTMGP.Sources.SourceLWNoScat","page":"Source Functions","title":"RRTMGP.Sources.SourceLWNoScat","text":"SourceLWNoScat{FT,FTA1D,FTA2D} <: AbstractSourceLW{FT,FTA1D,FTA2D}\n\nLongwave sources: computed at layer center, layer edges,  and at the surface for no scattering calculations\n\nFields\n\nparam_set: Parameter set\nlay_source: Planck source at layer average temperature [W/m2] (nlay, ncol)\nlev_source_inc: Planck source at layer edge in increasing ilay direction [W/m2] (nlay, ncol), includes spectral weighting that accounts for state-dependent frequency to g-space mapping\nlev_source_dec: Planck source at layer edge in decreasing ilay direction [W/m2] (nlay, ncol), includes spectral weighting that accounts for state-dependent frequency to g-space mapping\nsfc_source: Surface source [W/m2] (ncol)\nsrc_up: temporary storage array used in no scattering GPU calculations (nlay, ncol)\nsrc_dn: temporary storage array used in no scattering GPU calculations (nlay, ncol)\n\n\n\n\n\n","category":"type"},{"location":"optics/Sources/#RRTMGP.Sources.SourceLW2Str","page":"Source Functions","title":"RRTMGP.Sources.SourceLW2Str","text":"SourceLW2Str{FT,FTA1D,FTA2D} <: AbstractSourceLW{FT,FTA1D,FTA2D}\n\nLongwave sources: computed at layer center, layer edges,  and at the surface for 2-stream calculations\n\nFields\n\nparam_set: Parameter set\nlay_source: Planck source at layer average temperature [W/m2] (nlay, ncol)\nlev_source_inc: Planck source at layer edge in increasing ilay direction [W/m2] (nlay, ncol), includes spectral weighting that accounts for state-dependent frequency to g-space mapping\nlev_source_dec: Planck source at layer edge in decreasing ilay direction [W/m2] (nlay, ncol), includes spectral weighting that accounts for state-dependent frequency to g-space mapping\nsfc_source: Surface source [W/m2] (ncol)\nlev_source: level source [W/m2] (nlay+1, ncol), used in 2 stream calculations\nsrc_up: temporary storage array, used in 2 stream calculations (nlay, ncol)\nsrc_dn: temporary storage array, used in 2 stream calculations (nlay, ncol)\nRdif: temporary storage array, used in 2 stream calculations (nlay, ncol)\nTdif: temporary storage array, used in 2 stream calculations (nlay, ncol)\nalbedo: temporary storage array, used in 2 stream calculations (nlay + 1, ncol)\nsrc: temporary storage array, used in 2 stream calculations (nlay + 1, ncol)\n\n\n\n\n\n","category":"type"},{"location":"optics/Sources/#RRTMGP.Sources.SourceSW2Str","page":"Source Functions","title":"RRTMGP.Sources.SourceSW2Str","text":"SourceSW2Str{FT,FTA1D,FTA2D}\n\nShortwave sources: computed at layer center, layer edges,  and at the surface for 2-stream calculations\n\nFields\n\nsfc_source: surface source (ncol)\nalbedo: albedo (nlay + 1, ncol)\nsrc: temporary storage array, used in 2 stream calculations (nlay + 1, ncol)\n\n\n\n\n\n","category":"type"},{"location":"optics/Sources/#RRTMGP.Sources.source_func_longwave","page":"Source Functions","title":"RRTMGP.Sources.source_func_longwave","text":"source_func_longwave(\n    param_set,\n    ::Type{FT},\n    ncol::Int,\n    nlay::Int,\n    OPC::Symbol,\n    ::Type{DA},\n) where {FT<:AbstractFloat,DA}\n\nInitializes the longwave source for one scalar and two stream simulations.\n\n\n\n\n\n","category":"function"},{"location":"optics/Sources/#RRTMGP.Sources.source_func_shortwave","page":"Source Functions","title":"RRTMGP.Sources.source_func_shortwave","text":"source_func_shortwave(\n    ::Type{FT},\n    ncol::Int,\n    nlay::Int,\n    opc::Symbol,\n    ::Type{DA},\n) where {FT<:AbstractFloat,DA}\n\nInitializes the shortwave source for one scalar and two stream simulations.\n\n\n\n\n\n","category":"function"},{"location":"#RRTMGP.jl","page":"Home","title":"RRTMGP.jl","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Julia implementation of RTE-RRTMGP.","category":"page"},{"location":"#Code-structure","page":"Home","title":"Code structure","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"RRTMGP is fundamentally split into two parts:","category":"page"},{"location":"","page":"Home","title":"Home","text":"Optics computes optical properties and source functions given atmospheric conditions (e.g., pressure, temperature, gas concentrations).\nRTE computes radiative fluxes given optical properties and source functions.","category":"page"},{"location":"#Authors","page":"Home","title":"Authors","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"RRTMGP.jl is being developed by the Climate Modeling Alliance.","category":"page"},{"location":"optics/Fluxes/#Fluxes","page":"Fluxes","title":"Fluxes","text":"","category":"section"},{"location":"optics/Fluxes/","page":"Fluxes","title":"Fluxes","text":"CurrentModule = RRTMGP.Fluxes","category":"page"},{"location":"optics/Fluxes/","page":"Fluxes","title":"Fluxes","text":"FluxLW\nFluxSW\nset_flux_to_zero!\nadd_to_flux!","category":"page"},{"location":"optics/Fluxes/#RRTMGP.Fluxes.FluxLW","page":"Fluxes","title":"RRTMGP.Fluxes.FluxLW","text":"FluxLW{FT,FTA2D}\n\nUpward, downward and net longwave fluxes at each level.\n\nFields\n\nflux_up: upward flux [W/m²] (nlev,ncol)\nflux_dn: downward flux [W/m²] (nlev,ncol)\nflux_net: net flux [W/m²] (nlev,ncol)\n\n\n\n\n\n","category":"type"},{"location":"optics/Fluxes/#RRTMGP.Fluxes.FluxSW","page":"Fluxes","title":"RRTMGP.Fluxes.FluxSW","text":"FluxSW{FT,FTA2D}\n\nUpward, downward and net shortwave fluxes at each level.\n\nFields\n\nflux_up: upward flux [W/m²] (nlev,ncol)\nflux_dn: downward flux [W/m²] (nlev,ncol)\nflux_net: net flux [W/m²] (nlev,ncol)\nflux_dn_dir: direct downward flux [W/m²] (nlev,ncol)\n\n\n\n\n\n","category":"type"},{"location":"optics/Fluxes/#RRTMGP.Fluxes.set_flux_to_zero!","page":"Fluxes","title":"RRTMGP.Fluxes.set_flux_to_zero!","text":"set_flux_to_zero!(flux::FluxLW{FT}) where {FT<:AbstractFloat}\n\nSet longwave flux to zero\n\n\n\n\n\nset_flux_to_zero!(flux::FluxLW{FT}, gcol::Int) where {FT<:AbstractFloat}\n\nSet longwave flux for column gcol to zero\n\n\n\n\n\nset_flux_to_zero!(flux::FluxSW{FT}) where {FT<:AbstractFloat}\n\nSet shortwave flux to zero\n\n\n\n\n\nset_flux_to_zero!(flux::FluxSW{FT}, gcol::Int) where {FT<:AbstractFloat}\n\nSet shortwave flux for column gcol to zero\n\n\n\n\n\n","category":"function"},{"location":"optics/Fluxes/#RRTMGP.Fluxes.add_to_flux!","page":"Fluxes","title":"RRTMGP.Fluxes.add_to_flux!","text":"add_to_flux!(flux1::FluxLW, flux2::FluxLW)\n\nadd longwave flux2 to longwave flux1  flux1 .+= flux2\n\n\n\n\n\nadd_to_flux!(flux1::FluxLW, flux2::FluxLW, gcol::Int)\n\nadd longwave flux2 to longwave flux1 for column gcol flux1 .+= flux2\n\n\n\n\n\nadd_to_flux!(flux1::FluxSW, flux2::FluxSW)\n\nadd shortwave flux2 to shortwave flux1  flux1 .+= flux2\n\n\n\n\n\nadd_to_flux!(flux1::FluxSW, flux2::FluxSW, gcol::Int)\n\nadd shortwave flux2 to shortwave flux1 for column gcol flux1 .+= flux2\n\n\n\n\n\n","category":"function"}]
}
